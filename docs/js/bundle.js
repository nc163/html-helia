/*! For license information please see bundle.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.HtmlIpfs=t():e.HtmlIpfs=t()}(self,(()=>(()=>{var e={650:(e,t)=>{"use strict";const r=-8,n=-4,i=0,o=1,s=1,a=2,c=5,h=1024,u=2048,f=8192,l=0,d=4,p=8,b=12,y=12,w=16,g="undefined"!=typeof BigUint64Array,m=Symbol(),v=1024;function x(e,t){const r=new Uint32Array(e),i=new Uint16Array(e);var o=r[t+n>>>2]>>>1,s=t>>>1;if(o<=v)return String.fromCharCode.apply(String,i.subarray(s,s+o));const a=[];do{const e=i[s+v-1],t=e>=55296&&e<56320?v-1:v;a.push(String.fromCharCode.apply(String,i.subarray(s,s+=t))),o-=t}while(o>v);return a.join("")+String.fromCharCode.apply(String,i.subarray(s,s+o))}function A(e){const t={};function r(e,t){return e?x(e.buffer,t):"<yet unknown>"}const n=e.env=e.env||{};return n.abort=n.abort||function(e,i,o,s){const a=t.memory||n.memory;throw Error("abort: "+r(a,e)+" at "+r(a,i)+":"+o+":"+s)},n.trace=n.trace||function(e,i){const o=t.memory||n.memory;console.log("trace: "+r(o,e)+(i?" ":"")+Array.prototype.slice.call(arguments,2,2+i).join(", "))},e.Math=e.Math||Math,e.Date=e.Date||Date,t}function E(e,t){const m=t.exports,v=m.memory,A=m.table,E=m.__alloc,C=m.__retain,k=m.__rtti_base||-1;function S(e){const t=new Uint32Array(v.buffer);if((e>>>=0)>=t[k>>>2])throw Error("invalid id: "+e);return t[(k+4>>>2)+2*e]}function U(e){const t=new Uint32Array(v.buffer);if((e>>>=0)>=t[k>>>2])throw Error("invalid id: "+e);return t[(k+4>>>2)+2*e+1]}function I(e){return 31-Math.clz32(e>>>c&31)}function T(e,t,r){const n=v.buffer;if(r)switch(e){case 2:return new Float32Array(n);case 3:return new Float64Array(n)}else switch(e){case 0:return new(t?Int8Array:Uint8Array)(n);case 1:return new(t?Int16Array:Uint16Array)(n);case 2:return new(t?Int32Array:Uint32Array)(n);case 3:return new(t?BigInt64Array:BigUint64Array)(n)}throw Error("unsupported align: "+e)}function D(e){const t=new Uint32Array(v.buffer),i=t[e+r>>>2],o=S(i);if(!(o&s))throw Error("not an array: "+i);const c=I(o);var f=t[e+d>>>2];const l=o&a?t[e+y>>>2]:t[f+n>>>2]>>>c;return T(c,o&h,o&u).subarray(f>>>=c,f+l)}function B(e,t,r){return new e(P(e,t,r))}function P(e,t,r){const i=v.buffer,o=new Uint32Array(i),s=o[r+d>>>2];return new e(i,s,o[s+n>>>2]>>>t)}return e.__allocString=function(e){const t=e.length,r=E(t<<1,o),n=new Uint16Array(v.buffer);for(var i=0,s=r>>>1;i<t;++i)n[s+i]=e.charCodeAt(i);return r},e.__getString=function(e){const t=v.buffer;if(new Uint32Array(t)[e+r>>>2]!==o)throw Error("not a string: "+e);return x(t,e)},e.__allocArray=function(e,t){const r=S(e);if(!(r&(s|a)))throw Error("not an array: "+e+" @ "+r);const n=I(r),o=t.length,c=E(o<<n,i),g=E(r&a?w:b,e),m=new Uint32Array(v.buffer);m[g+l>>>2]=C(c),m[g+d>>>2]=c,m[g+p>>>2]=o<<n,r&a&&(m[g+y>>>2]=o);const x=T(n,r&h,r&u);if(r&f)for(let e=0;e<o;++e)x[(c>>>n)+e]=C(t[e]);else x.set(t,c>>>n);return g},e.__getArrayView=D,e.__getArray=function(e){const t=D(e),r=t.length,n=new Array(r);for(let e=0;e<r;e++)n[e]=t[e];return n},e.__getArrayBuffer=function(e){const t=v.buffer,r=new Uint32Array(t)[e+n>>>2];return t.slice(e,e+r)},e.__getInt8Array=B.bind(null,Int8Array,0),e.__getInt8ArrayView=P.bind(null,Int8Array,0),e.__getUint8Array=B.bind(null,Uint8Array,0),e.__getUint8ArrayView=P.bind(null,Uint8Array,0),e.__getUint8ClampedArray=B.bind(null,Uint8ClampedArray,0),e.__getUint8ClampedArrayView=P.bind(null,Uint8ClampedArray,0),e.__getInt16Array=B.bind(null,Int16Array,1),e.__getInt16ArrayView=P.bind(null,Int16Array,1),e.__getUint16Array=B.bind(null,Uint16Array,1),e.__getUint16ArrayView=P.bind(null,Uint16Array,1),e.__getInt32Array=B.bind(null,Int32Array,2),e.__getInt32ArrayView=P.bind(null,Int32Array,2),e.__getUint32Array=B.bind(null,Uint32Array,2),e.__getUint32ArrayView=P.bind(null,Uint32Array,2),g&&(e.__getInt64Array=B.bind(null,BigInt64Array,3),e.__getInt64ArrayView=P.bind(null,BigInt64Array,3),e.__getUint64Array=B.bind(null,BigUint64Array,3),e.__getUint64ArrayView=P.bind(null,BigUint64Array,3)),e.__getFloat32Array=B.bind(null,Float32Array,2),e.__getFloat32ArrayView=P.bind(null,Float32Array,2),e.__getFloat64Array=B.bind(null,Float64Array,3),e.__getFloat64ArrayView=P.bind(null,Float64Array,3),e.__instanceof=function(e,t){const n=new Uint32Array(v.buffer);var i=n[e+r>>>2];if(i<=n[k>>>2])do{if(i==t)return!0}while(i=U(i));return!1},e.memory=e.memory||v,e.table=e.table||A,_(m,e)}function C(e){return"undefined"!=typeof Response&&e instanceof Response}async function k(e,t){return C(e=await e)?S(e,t):E(A(t||(t={})),await WebAssembly.instantiate(e instanceof WebAssembly.Module?e:await WebAssembly.compile(e),t))}async function S(e,t){return WebAssembly.instantiateStreaming?E(A(t||(t={})),(await WebAssembly.instantiateStreaming(e,t)).instance):k(C(e=await e)?e.arrayBuffer():e,t)}function _(e,t){var r=t?Object.create(t):{},n=e.__argumentsLength?function(t){e.__argumentsLength.value=t}:e.__setArgumentsLength||e.__setargc||function(){};for(let t in e){if(!Object.prototype.hasOwnProperty.call(e,t))continue;const i=e[t];let o=t.split("."),s=r;for(;o.length>1;){let e=o.shift();Object.prototype.hasOwnProperty.call(s,e)||(s[e]={}),s=s[e]}let a=o[0],c=a.indexOf("#");if(c>=0){let r=a.substring(0,c),o=s[r];if(void 0===o||!o.prototype){let e=function(...t){return e.wrap(e.prototype.constructor(0,...t))};e.prototype={valueOf:function(){return this[m]}},e.wrap=function(t){return Object.create(e.prototype,{[m]:{value:t,writable:!1}})},o&&Object.getOwnPropertyNames(o).forEach((t=>Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t)))),s[r]=e}if(a=a.substring(c+1),s=s[r].prototype,/^(get|set):/.test(a)){if(!Object.prototype.hasOwnProperty.call(s,a=a.substring(4))){let r=e[t.replace("set:","get:")],n=e[t.replace("get:","set:")];Object.defineProperty(s,a,{get:function(){return r(this[m])},set:function(e){n(this[m],e)},enumerable:!0})}}else"constructor"===a?(s[a]=(...e)=>(n(e.length),i(...e))).original=i:(s[a]=function(...e){return n(e.length),i(this[m],...e)}).original=i}else/^(get|set):/.test(a)?Object.prototype.hasOwnProperty.call(s,a=a.substring(4))||Object.defineProperty(s,a,{get:e[t.replace("set:","get:")],set:e[t.replace("get:","set:")],enumerable:!0}):"function"==typeof i&&i!==n?(s[a]=(...e)=>(n(e.length),i(...e))).original=i:s[a]=i}return r}t.instantiate=k,t.instantiateSync=function(e,t){return E(A(t||(t={})),new WebAssembly.Instance(e instanceof WebAssembly.Module?e:new WebAssembly.Module(e),t))},t.instantiateStreaming=S,t.demangle=_},597:(e,t)=>{"use strict";var r=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,n=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,i=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,o=/\\([\u000b\u0020-\u00ff])/g,s=/([\\"])/g,a=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;function c(e){var t=String(e);if(i.test(t))return t;if(t.length>0&&!n.test(t))throw new TypeError("invalid parameter value");return'"'+t.replace(s,"\\$1")+'"'}function h(e){this.parameters=Object.create(null),this.type=e}t.format=function(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var t=e.parameters,r=e.type;if(!r||!a.test(r))throw new TypeError("invalid type");var n=r;if(t&&"object"==typeof t)for(var o,s=Object.keys(t).sort(),h=0;h<s.length;h++){if(o=s[h],!i.test(o))throw new TypeError("invalid parameter name");n+="; "+o+"="+c(t[o])}return n},t.parse=function(e){if(!e)throw new TypeError("argument string is required");var t="object"==typeof e?function(e){var t;if("function"==typeof e.getHeader?t=e.getHeader("content-type"):"object"==typeof e.headers&&(t=e.headers&&e.headers["content-type"]),"string"!=typeof t)throw new TypeError("content-type header is missing from object");return t}(e):e;if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var n=t.indexOf(";"),i=-1!==n?t.slice(0,n).trim():t.trim();if(!a.test(i))throw new TypeError("invalid media type");var s=new h(i.toLowerCase());if(-1!==n){var c,u,f;for(r.lastIndex=n;u=r.exec(t);){if(u.index!==n)throw new TypeError("invalid parameter format");n+=u[0].length,c=u[1].toLowerCase(),34===(f=u[2]).charCodeAt(0)&&-1!==(f=f.slice(1,-1)).indexOf("\\")&&(f=f.replace(o,"$1")),s.parameters[c]=f}if(n!==t.length)throw new TypeError("invalid parameter format")}return s}},833:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(736)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},736:(e,t,r)=>{e.exports=function(e){function t(e){let r,i,o,s=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),o=i-(r||i);n.diff=o,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";s++;const o=t.formatters[i];if("function"==typeof o){const t=e[s];r=o.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(585),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},310:e=>{"use strict";function t(e,t){for(const r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}e.exports=function(e,r,n){if(!e||"string"==typeof e)throw new TypeError("Please pass an Error to err-code");n||(n={}),"object"==typeof r&&(n=r,r=""),r&&(n.code=r);try{return t(e,n)}catch(r){n.message=e.message,n.stack=e.stack;const i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),t(new i,n)}}},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,o||e,s),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var c,h,u=this._events[a],f=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),f){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,s),!0}for(h=1,c=new Array(f-1);h<f;h++)c[h-1]=arguments[h];u.fn.apply(u.context,c)}else{var l,d=u.length;for(h=0;h<d;h++)switch(u[h].once&&this.removeListener(e,u[h].fn,void 0,!0),f){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,t);break;case 3:u[h].fn.call(u[h].context,t,n);break;case 4:u[h].fn.call(u[h].context,t,n,i);break;default:if(!c)for(l=1,c=new Array(f-1);l<f;l++)c[l-1]=arguments[l];u[h].fn.apply(u[h].context,c)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||s(this,o);else{for(var c=0,h=[],u=a.length;c<u;c++)(a[c].fn!==t||i&&!a[c].once||n&&a[c].context!==n)&&h.push(a[c]);h.length?this._events[o]=1===h.length?h[0]:h:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},368:e=>{"use strict";e.exports=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}},864:function(e,t,r){"use strict";const n=r(368),{hasOwnProperty:i}=Object.prototype,{propertyIsEnumerable:o}=Object,s=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0}),a=this,c={concatArrays:!1,ignoreUndefined:!1},h=e=>{const t=[];for(const r in e)i.call(e,r)&&t.push(r);if(Object.getOwnPropertySymbols){const r=Object.getOwnPropertySymbols(e);for(const n of r)o.call(e,n)&&t.push(n)}return t};function u(e){return Array.isArray(e)?function(e){const t=e.slice(0,0);return h(e).forEach((r=>{s(t,r,u(e[r]))})),t}(e):n(e)?function(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return h(e).forEach((r=>{s(t,r,u(e[r]))})),t}(e):e}const f=(e,t,r,n)=>(r.forEach((r=>{void 0===t[r]&&n.ignoreUndefined||(r in e&&e[r]!==Object.getPrototypeOf(e)?s(e,r,d(e[r],t[r],n)):s(e,r,u(t[r])))})),e),l=(e,t,r)=>{let n=e.slice(0,0),o=0;return[e,t].forEach((t=>{const a=[];for(let r=0;r<t.length;r++)i.call(t,r)&&(a.push(String(r)),s(n,o++,t===e?t[r]:u(t[r])));n=f(n,t,h(t).filter((e=>!a.includes(e))),r)})),n};function d(e,t,r){return r.concatArrays&&Array.isArray(e)&&Array.isArray(t)?l(e,t,r):n(t)&&n(e)?f(e,t,h(t),r):u(t)}e.exports=function(...e){const t=d(u(c),this!==a&&this||{},c);let r={_:{}};for(const i of e)if(void 0!==i){if(!n(i))throw new TypeError("`"+i+"` is not an Option Object");r=d(r,{_:i},t)}return r._}},585:e=>{var t=1e3,r=60*t,n=60*r,i=24*n;function o(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,s){s=s||{};var a,c,h=typeof e;if("string"===h&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var s=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*n;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===h&&isFinite(e))return s.long?(a=e,(c=Math.abs(a))>=i?o(a,c,i,"day"):c>=n?o(a,c,n,"hour"):c>=r?o(a,c,r,"minute"):c>=t?o(a,c,t,"second"):a+" ms"):function(e){var o=Math.abs(e);return o>=i?Math.round(e/i)+"d":o>=n?Math.round(e/n)+"h":o>=r?Math.round(e/r)+"m":o>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},437:(e,t,r)=>{e.exports=r(327)},327:function(e,t){!function(r,n){"use strict";var i={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function o(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function s(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function a(e,t){return e<<t|e>>>32-t}function c(e){return e=s(e^=e>>>16,2246822507),(e=s(e^=e>>>13,3266489909))^e>>>16}function h(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function u(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function f(e,t){return 32==(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function l(e,t){return 0==(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function d(e,t){return[e[0]^t[0],e[1]^t[1]]}function p(e){return e=d(e,[0,e[0]>>>1]),e=d(e=u(e,[4283543511,3981806797]),[0,e[0]>>>1]),d(e=u(e,[3301882366,444984403]),[0,e[0]>>>1])}i.x86.hash32=function(e,t){if(i.inputValidation&&!o(e))return n;t=t||0;for(var r=e.length%4,h=e.length-r,u=t,f=0,l=3432918353,d=461845907,p=0;p<h;p+=4)f=s(f=e[p]|e[p+1]<<8|e[p+2]<<16|e[p+3]<<24,l),f=s(f=a(f,15),d),u=s(u=a(u^=f,13),5)+3864292196;switch(f=0,r){case 3:f^=e[p+2]<<16;case 2:f^=e[p+1]<<8;case 1:f=s(f^=e[p],l),u^=f=s(f=a(f,15),d)}return(u=c(u^=e.length))>>>0},i.x86.hash128=function(e,t){if(i.inputValidation&&!o(e))return n;t=t||0;for(var r=e.length%16,h=e.length-r,u=t,f=t,l=t,d=t,p=0,b=0,y=0,w=0,g=597399067,m=2869860233,v=951274213,x=2716044179,A=0;A<h;A+=16)p=e[A]|e[A+1]<<8|e[A+2]<<16|e[A+3]<<24,b=e[A+4]|e[A+5]<<8|e[A+6]<<16|e[A+7]<<24,y=e[A+8]|e[A+9]<<8|e[A+10]<<16|e[A+11]<<24,w=e[A+12]|e[A+13]<<8|e[A+14]<<16|e[A+15]<<24,p=a(p=s(p,g),15),u=a(u^=p=s(p,m),19),u=s(u+=f,5)+1444728091,b=a(b=s(b,m),16),f=a(f^=b=s(b,v),17),f=s(f+=l,5)+197830471,y=a(y=s(y,v),17),l=a(l^=y=s(y,x),15),l=s(l+=d,5)+2530024501,w=a(w=s(w,x),18),d=a(d^=w=s(w,g),13),d=s(d+=u,5)+850148119;switch(p=0,b=0,y=0,w=0,r){case 15:w^=e[A+14]<<16;case 14:w^=e[A+13]<<8;case 13:w=s(w^=e[A+12],x),d^=w=s(w=a(w,18),g);case 12:y^=e[A+11]<<24;case 11:y^=e[A+10]<<16;case 10:y^=e[A+9]<<8;case 9:y=s(y^=e[A+8],v),l^=y=s(y=a(y,17),x);case 8:b^=e[A+7]<<24;case 7:b^=e[A+6]<<16;case 6:b^=e[A+5]<<8;case 5:b=s(b^=e[A+4],m),f^=b=s(b=a(b,16),v);case 4:p^=e[A+3]<<24;case 3:p^=e[A+2]<<16;case 2:p^=e[A+1]<<8;case 1:p=s(p^=e[A],g),u^=p=s(p=a(p,15),m)}return u^=e.length,u+=f^=e.length,u+=l^=e.length,f+=u+=d^=e.length,l+=u,d+=u,u=c(u),u+=f=c(f),u+=l=c(l),f+=u+=d=c(d),l+=u,d+=u,("00000000"+(u>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)+("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)},i.x64.hash128=function(e,t){if(i.inputValidation&&!o(e))return n;t=t||0;for(var r=e.length%16,s=e.length-r,a=[0,t],c=[0,t],b=[0,0],y=[0,0],w=[2277735313,289559509],g=[1291169091,658871167],m=0;m<s;m+=16)b=[e[m+4]|e[m+5]<<8|e[m+6]<<16|e[m+7]<<24,e[m]|e[m+1]<<8|e[m+2]<<16|e[m+3]<<24],y=[e[m+12]|e[m+13]<<8|e[m+14]<<16|e[m+15]<<24,e[m+8]|e[m+9]<<8|e[m+10]<<16|e[m+11]<<24],b=f(b=u(b,w),31),a=h(a=f(a=d(a,b=u(b,g)),27),c),a=h(u(a,[0,5]),[0,1390208809]),y=f(y=u(y,g),33),c=h(c=f(c=d(c,y=u(y,w)),31),a),c=h(u(c,[0,5]),[0,944331445]);switch(b=[0,0],y=[0,0],r){case 15:y=d(y,l([0,e[m+14]],48));case 14:y=d(y,l([0,e[m+13]],40));case 13:y=d(y,l([0,e[m+12]],32));case 12:y=d(y,l([0,e[m+11]],24));case 11:y=d(y,l([0,e[m+10]],16));case 10:y=d(y,l([0,e[m+9]],8));case 9:y=u(y=d(y,[0,e[m+8]]),g),c=d(c,y=u(y=f(y,33),w));case 8:b=d(b,l([0,e[m+7]],56));case 7:b=d(b,l([0,e[m+6]],48));case 6:b=d(b,l([0,e[m+5]],40));case 5:b=d(b,l([0,e[m+4]],32));case 4:b=d(b,l([0,e[m+3]],24));case 3:b=d(b,l([0,e[m+2]],16));case 2:b=d(b,l([0,e[m+1]],8));case 1:b=u(b=d(b,[0,e[m]]),w),a=d(a,b=u(b=f(b,31),g))}return a=h(a=d(a,[0,e.length]),c=d(c,[0,e.length])),c=h(c,a),a=h(a=p(a),c=p(c)),c=h(c,a),("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)+("00000000"+(c[0]>>>0).toString(16)).slice(-8)+("00000000"+(c[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=i),t.murmurHash3=i}()},68:(e,t,r)=>{const{instantiate:n}=r(650);function i(e={}){if(!i.supported)return null;var t=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return n(new Response(new Blob([t],{type:"application/wasm"})),e)}i.supported="undefined"!=typeof WebAssembly,e.exports=i},942:(e,t,r)=>{const n=r(407),i=r(68);e.exports={Rabin:n,create:async(e,t,r,o,s)=>{const a=await i();return new n(a,e,t,r,o,s)}}},407:e=>{e.exports=class{constructor(e,t=12,r=8192,n=32768,i=64,o){this.bits=t,this.min=r,this.max=n,this.asModule=e,this.rabin=new e.Rabin(t,r,n,i,o),this.polynomial=o}fingerprint(e){const{__retain:t,__release:r,__allocArray:n,__getInt32Array:i,Int32Array_ID:o,Uint8Array_ID:s}=this.asModule,a=t(n(o,new Int32Array(Math.ceil(e.length/this.min)))),c=t(n(s,e)),h=i(this.rabin.fingerprint(c,a));r(c),r(a);const u=h.indexOf(0);return u>=0?h.subarray(0,u):h}}},669:e=>{"use strict";function t(e,t){return e+r(t)}function r(e){let t=e;return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}function n(e,t){return e[0]-t[0]}function i(e){return e[1]}e.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let r=this._internalPositionFor(e,!1);if(void 0===t)-1!==r&&(this._unsetInternalPos(r),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;-1===r?(r=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(r,e,t,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();const t=this._internalPositionFor(e,!0);if(-1!==t)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){const e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,r=new Array(this.length);for(;t<this.length;)r[t]=e(this.get(t),t,this),t++;return r}reduce(e,t){let r=0,n=t;for(;r<this.length;)n=e(n,this.get(r),r),r++;return n}find(e){let t,r,n=0;for(;n<this.length&&!t;)r=this.get(n),t=e(r),n++;return t?r:void 0}_internalPositionFor(e,n){const i=this._bytePosFor(e,n);if(i>=this._bitArrays.length)return-1;const o=this._bitArrays[i],s=e-7*i;return(o&1<<s)>0?this._bitArrays.slice(0,i).reduce(t,0)+r(o&~(4294967295<<s+1))-1:-1}_bytePosFor(e,t){const r=Math.floor(e/7),n=r+1;for(;!t&&this._bitArrays.length<n;)this._bitArrays.push(0);return r}_setBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-7*t}_unsetBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-7*t)}_setInternalPos(e,t,r,n){const i=this._data,o=[t,r];if(n)this._sortData(),i[e]=o;else{if(i.length)if(i[i.length-1][0]>=t)i.push(o);else if(i[0][0]<=t)i.unshift(o);else{const e=Math.round(i.length/2);this._data=i.slice(0,e).concat(o).concat(i.slice(e))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(n),this._changedData=!1}bitField(){const e=[];let t,r=8,n=0,i=0;const o=this._bitArrays.slice();for(;o.length||n;){0===n&&(t=o.shift(),n=7);const s=Math.min(n,r);i|=(t&~(255<<s))<<8-r,t>>>=s,n-=s,r-=s,r&&(n||o.length)||(e.push(i),i=0,r=8)}for(var s=e.length-1;s>0&&0===e[s];s--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(i)}}},712:()=>{}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{"use strict";r.d(n,{default:()=>ew});var e={};r.r(e),r.d(e,{code:()=>Ut,createLink:()=>St,createNode:()=>kt,decode:()=>Tt,encode:()=>It,name:()=>_t,prepare:()=>Et,validate:()=>Ct});var t={};r.r(t),r.d(t,{base10:()=>yr});var i={};r.r(i),r.d(i,{base16:()=>wr,base16upper:()=>gr});var o={};r.r(o),r.d(o,{base2:()=>mr});var s={};r.r(s),r.d(s,{base256emoji:()=>Er});var a={};r.r(a),r.d(a,{base32:()=>Cr,base32hex:()=>Ur,base32hexpad:()=>Tr,base32hexpadupper:()=>Dr,base32hexupper:()=>Ir,base32pad:()=>Sr,base32padupper:()=>_r,base32upper:()=>kr,base32z:()=>Br});var c={};r.r(c),r.d(c,{base36:()=>Pr,base36upper:()=>Nr});var h={};r.r(h),r.d(h,{base58btc:()=>zr,base58flickr:()=>Lr});var u={};r.r(u),r.d(u,{base64:()=>Mr,base64pad:()=>$r,base64url:()=>Or,base64urlpad:()=>Fr});var f={};r.r(f),r.d(f,{base8:()=>Vr});var l={};r.r(l),r.d(l,{identity:()=>Rr});var d={};r.r(d),r.d(d,{code:()=>Jr,decode:()=>Wr,encode:()=>Gr,name:()=>qr});var p={};r.r(p),r.d(p,{code:()=>Kr,decode:()=>Zr,encode:()=>Xr,name:()=>Qr});var b={};r.r(b),r.d(b,{identity:()=>vn});var y={};r.r(y),r.d(y,{sha256:()=>Cn,sha512:()=>kn});var w={};r.r(w),r.d(w,{code:()=>ii,decode:()=>si,encode:()=>oi,name:()=>ni});var g={};r.r(g),r.d(g,{base32:()=>wi,base32hex:()=>xi,base32hexpad:()=>Ei,base32hexpadupper:()=>Ci,base32hexupper:()=>Ai,base32pad:()=>mi,base32padupper:()=>vi,base32upper:()=>gi,base32z:()=>ki});var m={};r.r(m),r.d(m,{base58btc:()=>Si,base58flickr:()=>_i});var v={};r.r(v),r.d(v,{sha256:()=>oo,sha512:()=>so});var x={};r.r(x),r.d(x,{base10:()=>yo});var A={};r.r(A),r.d(A,{base16:()=>wo,base16upper:()=>go});var E={};r.r(E),r.d(E,{base2:()=>mo});var C={};r.r(C),r.d(C,{base256emoji:()=>Eo});var k={};r.r(k),r.d(k,{base36:()=>Co,base36upper:()=>ko});var S={};r.r(S),r.d(S,{base64:()=>So,base64pad:()=>_o,base64url:()=>Uo,base64urlpad:()=>Io});var _={};r.r(_),r.d(_,{base8:()=>To});var U={};r.r(U),r.d(U,{identity:()=>Do});var I={};r.r(I),r.d(I,{code:()=>zo,decode:()=>Mo,encode:()=>Lo,name:()=>No});var T={};r.r(T),r.d(T,{identity:()=>Oo});var D={};r.r(D),r.d(D,{base10:()=>qs});var B={};r.r(B),r.d(B,{base16:()=>Js,base16upper:()=>Gs});var P={};r.r(P),r.d(P,{base2:()=>Ws});var N={};r.r(N),r.d(N,{base256emoji:()=>Zs});var z={};r.r(z),r.d(z,{base32:()=>Ys,base32hex:()=>na,base32hexpad:()=>oa,base32hexpadupper:()=>sa,base32hexupper:()=>ia,base32pad:()=>ta,base32padupper:()=>ra,base32upper:()=>ea,base32z:()=>aa});var L={};r.r(L),r.d(L,{base36:()=>ca,base36upper:()=>ha});var M={};r.r(M),r.d(M,{base58btc:()=>ua,base58flickr:()=>fa});var $={};r.r($),r.d($,{base64:()=>la,base64pad:()=>da,base64url:()=>pa,base64urlpad:()=>ba});var O={};r.r(O),r.d(O,{base8:()=>ya});var F={};r.r(F),r.d(F,{identity:()=>wa});var V={};r.r(V),r.d(V,{code:()=>xa,decode:()=>Ea,encode:()=>Aa,name:()=>va});var R={};r.r(R),r.d(R,{code:()=>ka,decode:()=>_a,encode:()=>Sa,name:()=>Ca});var j={};r.r(j),r.d(j,{identity:()=>Wa});var H={};r.r(H),r.d(H,{sha256:()=>Za,sha512:()=>Ya});var q={};r.r(q),r.d(q,{base32:()=>Bd,base32hex:()=>Ld,base32hexpad:()=>$d,base32hexpadupper:()=>Od,base32hexupper:()=>Md,base32pad:()=>Nd,base32padupper:()=>zd,base32upper:()=>Pd,base32z:()=>Fd});var J={};r.r(J),r.d(J,{base58btc:()=>Vd,base58flickr:()=>Rd});var G={};r.r(G),r.d(G,{sha256:()=>vp,sha512:()=>xp});var W={};r.r(W),r.d(W,{base10:()=>Ep});var Q={};r.r(Q),r.d(Q,{base16:()=>Cp,base16upper:()=>kp});var K={};r.r(K),r.d(K,{base2:()=>Sp});var X={};r.r(X),r.d(X,{base256emoji:()=>Tp});var Z={};r.r(Z),r.d(Z,{base36:()=>Dp,base36upper:()=>Bp});var Y={};r.r(Y),r.d(Y,{base64:()=>Pp,base64pad:()=>Np,base64url:()=>zp,base64urlpad:()=>Lp});var ee={};r.r(ee),r.d(ee,{base8:()=>Mp});var te={};r.r(te),r.d(te,{identity:()=>$p});var re={};r.r(re),r.d(re,{code:()=>Rp,decode:()=>Hp,encode:()=>jp,name:()=>Vp});var ne={};r.r(ne),r.d(ne,{code:()=>Jp,decode:()=>Wp,encode:()=>Gp,name:()=>qp});var ie={};r.r(ie),r.d(ie,{identity:()=>Kp});var oe=r(310);const se=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e)return t})();for(const t of e)return t},ae=function(e,t=1){return t=Number(t),null!=e[Symbol.asyncIterator]?async function*(){let r=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for await(const n of e)for(r.push(n);r.length>=t;)yield r.slice(0,t),r=r.slice(t);for(;r.length>0;)yield r.slice(0,t),r=r.slice(t)}():function*(){let r=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for(const n of e)for(r.push(n);r.length>=t;)yield r.slice(0,t),r=r.slice(t);for(;r.length>0;)yield r.slice(0,t),r=r.slice(t)}()};async function*ce(e,t=1){for await(const r of ae(e,t)){const e=r.map((async e=>e().then((e=>({ok:!0,value:e})),(e=>({ok:!1,err:e})))));for(let t=0;t<e.length;t++){const r=await e[t];if(!r.ok)throw r.err;yield r.value}}}function he(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function ue(e=0){return null!=globalThis.Buffer?.alloc?he(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function fe(e=0){return null!=globalThis.Buffer?.allocUnsafe?he(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function le(e,t){if(null!=globalThis.Buffer)return he(globalThis.Buffer.concat(e,t));null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=fe(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return he(r)}function de(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const pe=Symbol.for("@achingbrain/uint8arraylist");function be(e,t){if(null==t||t<0)throw new RangeError("index is out of bounds");let r=0;for(const n of e){const e=r+n.byteLength;if(t<e)return{buf:n,index:t-r};r=e}throw new RangeError("index is out of bounds")}function ye(e){return Boolean(e?.[pe])}class we{bufs;length;[pe]=!0;constructor(...e){this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(const r of e)if(r instanceof Uint8Array)t+=r.byteLength,this.bufs.push(r);else{if(!ye(r))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");t+=r.byteLength,this.bufs.push(...r.bufs)}this.length+=t}prepend(...e){this.prependAll(e)}prependAll(e){let t=0;for(const r of e.reverse())if(r instanceof Uint8Array)t+=r.byteLength,this.bufs.unshift(r);else{if(!ye(r))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");t+=r.byteLength,this.bufs.unshift(...r.bufs)}this.length+=t}get(e){const t=be(this.bufs,e);return t.buf[t.index]}set(e,t){const r=be(this.bufs,e);r.buf[r.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let r=0;r<e.length;r++)this.set(t+r,e[r]);else{if(!ye(e))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(let r=0;r<e.length;r++)this.set(t+r,e.get(r))}}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength)return this.bufs=[],void(this.length=0);for(;this.bufs.length>0;){if(!(e>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}}slice(e,t){const{bufs:r,length:n}=this._subList(e,t);return le(r,n)}subarray(e,t){const{bufs:r,length:n}=this._subList(e,t);return 1===r.length?r[0]:le(r,n)}sublist(e,t){const{bufs:r,length:n}=this._subList(e,t),i=new we;return i.length=n,i.bufs=[...r],i}_subList(e,t){if(e=e??0,t=t??this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(0===e&&t===this.length)return{bufs:this.bufs,length:this.length};const r=[];let n=0;for(let i=0;i<this.bufs.length;i++){const o=this.bufs[i],s=n,a=s+o.byteLength;if(n=a,e>=a)continue;const c=e>=s&&e<a,h=t>s&&t<=a;if(c&&h){if(e===s&&t===a){r.push(o);break}const n=e-s;r.push(o.subarray(n,n+(t-e)));break}if(c){if(0===e){r.push(o);continue}r.push(o.subarray(e-s))}else{if(h){if(t===a){r.push(o);break}r.push(o.subarray(0,t-s));break}r.push(o)}}return{bufs:r,length:t-e}}indexOf(e,t=0){if(!(ye(e)||e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const r=e instanceof Uint8Array?e:e.subarray();if(t=Number(t??0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;const n=r.byteLength;if(0===n)throw new TypeError("search must be at least 1 byte long");const i=new Int32Array(256);for(let e=0;e<256;e++)i[e]=-1;for(let e=0;e<n;e++)i[r[e]]=e;const o=i,s=this.byteLength-r.byteLength,a=r.byteLength-1;let c;for(let e=t;e<=s;e+=c){c=0;for(let t=a;t>=0;t--){const n=this.get(e+t);if(r[t]!==n){c=Math.max(1,t-o[n]);break}}if(0===c)return e}return-1}getInt8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){const r=fe(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt8(0,t),this.write(r,e)}getInt16(e,t){const r=this.subarray(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt16(0,t)}setInt16(e,t,r){const n=ue(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt16(0,t,r),this.write(n,e)}getInt32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt32(0,t)}setInt32(e,t,r){const n=ue(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt32(0,t,r),this.write(n,e)}getBigInt64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigInt64(0,t)}setBigInt64(e,t,r){const n=ue(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigInt64(0,t,r),this.write(n,e)}getUint8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){const r=fe(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint8(0,t),this.write(r,e)}getUint16(e,t){const r=this.subarray(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0,t)}setUint16(e,t,r){const n=ue(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint16(0,t,r),this.write(n,e)}getUint32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint32(0,t)}setUint32(e,t,r){const n=ue(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,t,r),this.write(n,e)}getBigUint64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigUint64(0,t)}setBigUint64(e,t,r){const n=ue(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigUint64(0,t,r),this.write(n,e)}getFloat32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat32(0,t)}setFloat32(e,t,r){const n=ue(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat32(0,t,r),this.write(n,e)}getFloat64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat64(0,t)}setFloat64(e,t,r){const n=ue(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat64(0,t,r),this.write(n,e)}equals(e){if(null==e)return!1;if(!(e instanceof we))return!1;if(e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!de(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){const r=new we;return r.bufs=e,null==t&&(t=e.reduce(((e,t)=>e+t.byteLength),0)),r.length=t,r}}const ge=(e={})=>{const t=e.chunkSize??262144;return async function*(e){let r=new we,n=0,i=!1;for await(const o of e)for(r.append(o),n+=o.length;n>=t;)if(yield r.slice(0,t),i=!0,t===r.length)r=new we,n=0;else{const e=new we;e.append(r.sublist(t)),r=e,n-=t}(!i||n>0)&&(yield r.subarray(0,n))}};function me(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const ve=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*h+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,l=o-1;(0!==u||f<i)&&-1!==l;l--,f++)u+=a*s[l]>>>0,s[l]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),b=n;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=t[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var b=c.repeat(r);p<s;++p)b+=e.charAt(h[p]);return b},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class xe{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ae{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ce(this,e)}}class Ee{decoders;constructor(e){this.decoders=e}or(e){return Ce(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function Ce(e,t){return new Ee({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class ke{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new xe(e,t,r),this.decoder=new Ae(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function Se({name:e,prefix:t,encode:r,decode:n}){return new ke(e,t,r,n)}function _e({name:e,prefix:t,alphabet:r}){const{encode:n,decode:i}=ve(r,e);return Se({prefix:t,name:e,encode:n,decode:e=>me(i(e))})}function Ue({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return Se({prefix:t,name:e,encode:e=>function(e,t,r){const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,n,r),decode:t=>function(e,t,r,n){const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s}(t,n,r,e)})}const Ie=Ue({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Te=(Ue({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ue({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ue({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ue({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ue({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ue({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ue({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ue({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),_e({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));_e({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var De=128,Be=-128,Pe=Math.pow(2,31),Ne=128,ze=127,Le=Math.pow(2,7),Me=Math.pow(2,14),$e=Math.pow(2,21),Oe=Math.pow(2,28),Fe=Math.pow(2,35),Ve=Math.pow(2,42),Re=Math.pow(2,49),je=Math.pow(2,56),He=Math.pow(2,63);const qe={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Pe;)r[n++]=255&t|De,t/=128;for(;t&Be;)r[n++]=255&t|De,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&ze)<<o:(n&ze)*Math.pow(2,o),o+=7}while(n>=Ne);return e.bytes=s-r,i},encodingLength:function(e){return e<Le?1:e<Me?2:e<$e?3:e<Oe?4:e<Fe?5:e<Ve?6:e<Re?7:e<je?8:e<He?9:10}};function Je(e,t=0){return[qe.decode(e,t),qe.decode.bytes]}function Ge(e,t,r=0){return qe.encode(e,t,r),t}function We(e){return qe.encodingLength(e)}class Qe{code;size;digest;bytes;constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}function Ke(e,t){const{bytes:r,version:n}=e;return 0===n?function(e,t,r){const{prefix:n}=r;if(n!==Te.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i}(r,Ze(e),t??Te.encoder):function(e,t,r){const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i}(r,Ze(e),t??Ie.encoder)}const Xe=new WeakMap;function Ze(e){const t=Xe.get(e);if(null==t){const t=new Map;return Xe.set(e,t),t}return t}class Ye{code;version;multihash;bytes;"/";constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==et)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==tt)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ye.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=function(e,t){const r=t.byteLength,n=We(e),i=n+We(r),o=new Uint8Array(i+r);return Ge(e,o,0),Ge(r,o,n),o.set(t,i),new Qe(e,r,t,o)}(e,t);return Ye.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ye.equals(this,e)}static equals(e,t){const r=t;return null!=r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}}(e.multihash,r.multihash)}toString(e){return Ke(this,e)}toJSON(){return{"/":Ke(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Ye)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new Ye(e,r,n,i??rt(e,r,n.bytes))}if(!0===t[nt]){const{version:e,multihash:r,code:n}=t,i=function(e){const t=me(e),[r,n]=Je(t),[i,o]=Je(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Qe(r,i,s,t)}(r);return Ye.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==et)throw new Error(`Version 0 CID must use dag-pb (code: ${et}) block encoding`);return new Ye(e,t,r,r.bytes);case 1:{const n=rt(e,t,r.bytes);return new Ye(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Ye.create(0,et,e)}static createV1(e,t){return Ye.create(1,e,t)}static decode(e){const[t,r]=Ye.decodeFirst(e);if(0!==r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Ye.inspectBytes(e),r=t.size-t.multihashSize,n=me(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new Qe(t.multihashCode,t.digestSize,i,n);return[0===t.version?Ye.createV0(o):Ye.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=Je(e.subarray(t));return t+=n,r};let n=r(),i=et;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=t,s=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[r,n]=function(e,t){switch(e[0]){case"Q":{const r=t??Te;return[Te.prefix,r.decode(`${Te.prefix}${e}`)]}case Te.prefix:{const r=t??Te;return[Te.prefix,r.decode(e)]}case Ie.prefix:{const r=t??Ie;return[Ie.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}(e,t),i=Ye.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Ze(i).set(r,e),i}}const et=112,tt=18;function rt(e,t,r){const n=We(e),i=n+We(t),o=new Uint8Array(i+r.byteLength);return Ge(e,o,0),Ge(t,o,n),o.set(r,i),o}const nt=Symbol.for("@ipld/js-cid/CID"),it=new TextDecoder;function ot(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const i=e[t++];if(r+=n<28?(127&i)<<n:(127&i)*2**n,i<128)break}return[r,t]}function st(e,t){let r;[r,t]=ot(e,t);const n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function at(e,t){let r;return[r,t]=ot(e,t),[7&r,r>>3,t]}function ct(e){const t={},r=e.length;let n=0;for(;n<r;){let r,i;if([r,i,n]=at(e,n),1===i){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Hash`);if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=st(e,n)}else if(2===i){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Name`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let i;[i,n]=st(e,n),t.Name=it.decode(i)}else{if(3!==i)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${i}`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Tsize`);[t.Tsize,n]=ot(e,n)}}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}const ht=new TextEncoder,ut=2**32,ft=2**31;function lt(e,t){let r=t.length;if("number"==typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");r=pt(t,r,e.Tsize)-1,t[r]=24}if("string"==typeof e.Name){const n=ht.encode(e.Name);r-=n.length,t.set(n,r),r=pt(t,r,n.length)-1,t[r]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),r=pt(t,r,e.Hash.length)-1,t[r]=10),t.length-r}function dt(e){let t=0;if(e.Hash){const r=e.Hash.length;t+=1+r+bt(r)}if("string"==typeof e.Name){const r=ht.encode(e.Name).length;t+=1+r+bt(r)}return"number"==typeof e.Tsize&&(t+=1+bt(e.Tsize)),t}function pt(e,t,r){const n=t-=bt(r);for(;r>=ft;)e[t++]=127&r|128,r/=128;for(;r>=128;)e[t++]=127&r|128,r>>>=7;return e[t]=r,n}function bt(e){return e%2==0&&e++,Math.floor((function(e){let t=0;return e>=ut&&(e=Math.floor(e/ut),t=32),e>=65536&&(e>>>=16,t+=16),e>=256&&(e>>>=8,t+=8),t+yt[e]}(e)+6)/7)}const yt=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],wt=["Data","Links"],gt=["Hash","Name","Tsize"],mt=new TextEncoder;function vt(e,t){if(e===t)return 0;const r=e.Name?mt.encode(e.Name):[],n=t.Name?mt.encode(t.Name):[];let i=r.length,o=n.length;for(let e=0,t=Math.min(i,o);e<t;++e)if(r[e]!==n[e]){i=r[e],o=n[e];break}return i<o?-1:o<i?1:0}function xt(e,t){return!Object.keys(e).some((e=>!t.includes(e)))}function At(e){if("object"==typeof e.asCID){const t=Ye.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let r=Ye.asCID(e.Hash);try{r||("string"==typeof e.Hash?r=Ye.parse(e.Hash):e.Hash instanceof Uint8Array&&(r=Ye.decode(e.Hash)))}catch(e){throw new TypeError(`Invalid DAG-PB form: ${e.message}`)}r&&(t.Hash=r)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return"string"==typeof e.Name&&(t.Name=e.Name),"number"==typeof e.Tsize&&(t.Tsize=e.Tsize),t}function Et(e){if((e instanceof Uint8Array||"string"==typeof e)&&(e={Data:e}),"object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(void 0!==e.Data)if("string"==typeof e.Data)t.Data=mt.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");t.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");t.Links=e.Links.map(At),t.Links.sort(vt)}else t.Links=[];return t}function Ct(e){if(!e||"object"!=typeof e||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!xt(e,wt))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<e.Links.length;t++){const r=e.Links[t];if(!r||"object"!=typeof r||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!xt(r,gt))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==r.Hash||!r.Hash["/"]||r.Hash["/"]!==r.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==r.Name&&"string"!=typeof r.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==r.Tsize){if("number"!=typeof r.Tsize||r.Tsize%1!=0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(r.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&-1===vt(r,e.Links[t-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function kt(e,t=[]){return Et({Data:e,Links:t})}function St(e,t,r){return At({Hash:r,Name:e,Tsize:t})}const _t="dag-pb",Ut=112;function It(e){Ct(e);const t={};return e.Links&&(t.Links=e.Links.map((e=>{const t={};return e.Hash&&(t.Hash=e.Hash.bytes),void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),e.Data&&(t.Data=e.Data),function(e){const t=function(e){let t=0;if(e.Data){const r=e.Data.length;t+=1+r+bt(r)}if(e.Links)for(const r of e.Links){const e=dt(r);t+=1+e+bt(e)}return t}(e),r=new Uint8Array(t);let n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),n=pt(r,n,e.Data.length)-1,r[n]=10),e.Links)for(let t=e.Links.length-1;t>=0;t--){const i=lt(e.Links[t],r.subarray(0,n));n-=i,n=pt(r,n,i)-1,r[n]=18}return r}(t)}function Tt(e){const t=function(e){const t=e.length;let r,n,i=0,o=!1;for(;i<t;){let t,s;if([t,s,i]=at(e,i),2!==t)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${t}`);if(1===s){if(n)throw new Error("protobuf: (PBNode) duplicate Data section");[n,i]=st(e,i),r&&(o=!0)}else{if(2!==s)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${s}`);{if(o)throw new Error("protobuf: (PBNode) duplicate Links section");let t;r||(r=[]),[t,i]=st(e,i),r.push(ct(t))}}}if(i>t)throw new Error("protobuf: (PBNode) unexpected end of data");const s={};return n&&(s.Data=n),s.Links=r||[],s}((n=e)instanceof ArrayBuffer?new Uint8Array(n,0,n.byteLength):n),r={};var n;return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map((e=>{const t={};try{t.Hash=Ye.decode(e.Hash)}catch(e){}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),r}const Dt=Math.pow(2,7),Bt=Math.pow(2,14),Pt=Math.pow(2,21),Nt=Math.pow(2,28),zt=Math.pow(2,35),Lt=Math.pow(2,42),Mt=Math.pow(2,49),$t=128,Ot=127;function Ft(e){if(e<Dt)return 1;if(e<Bt)return 2;if(e<Pt)return 3;if(e<Nt)return 4;if(e<zt)return 5;if(e<Lt)return 6;if(e<Mt)return 7;if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Vt(e,t,r=0){switch(Ft(e)){case 8:t[r++]=255&e|$t,e/=128;case 7:t[r++]=255&e|$t,e/=128;case 6:t[r++]=255&e|$t,e/=128;case 5:t[r++]=255&e|$t,e/=128;case 4:t[r++]=255&e|$t,e>>>=7;case 3:t[r++]=255&e|$t,e>>>=7;case 2:t[r++]=255&e|$t,e>>>=7;case 1:t[r++]=255&e,e>>>=7;break;default:throw new Error("unreachable")}return t}const Rt=new Float32Array([-0]),jt=new Uint8Array(Rt.buffer);function Ht(e,t,r){Rt[0]=e,t[r]=jt[0],t[r+1]=jt[1],t[r+2]=jt[2],t[r+3]=jt[3]}const qt=new Float64Array([-0]),Jt=new Uint8Array(qt.buffer);function Gt(e,t,r){qt[0]=e,t[r]=Jt[0],t[r+1]=Jt[1],t[r+2]=Jt[2],t[r+3]=Jt[3],t[r+4]=Jt[4],t[r+5]=Jt[5],t[r+6]=Jt[6],t[r+7]=Jt[7]}const Wt=BigInt(Number.MAX_SAFE_INTEGER),Qt=BigInt(Number.MIN_SAFE_INTEGER);class Kt{lo;hi;constructor(e,t){this.lo=0|e,this.hi=0|t}toNumber(e=!1){if(!e&&this.hi>>>31>0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(e+4294967296*t)}return this.lo+4294967296*this.hi}toBigInt(e=!1){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!=0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(BigInt(e)+(BigInt(t)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(e=!1){return this.toBigInt(e).toString()}zzEncode(){const e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){const e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){const e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}static fromBigInt(e){if(0n===e)return Xt;if(e<Wt&&e>Qt)return this.fromNumber(Number(e));const t=e<0n;t&&(e=-e);let r=e>>32n,n=e-(r<<32n);return t&&(r=0n|~r,n=0n|~n,++n>Zt&&(n=0n,++r>Zt&&(r=0n))),new Kt(Number(n),Number(r))}static fromNumber(e){if(0===e)return Xt;const t=e<0;t&&(e=-e);let r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new Kt(r,n)}static from(e){return"number"==typeof e?Kt.fromNumber(e):"bigint"==typeof e?Kt.fromBigInt(e):"string"==typeof e?Kt.fromBigInt(BigInt(e)):null!=e.low||null!=e.high?new Kt(e.low>>>0,e.high>>>0):Xt}}const Xt=new Kt(0,0);Xt.toBigInt=function(){return 0n},Xt.zzEncode=Xt.zzDecode=function(){return this},Xt.length=function(){return 1};const Zt=4294967296n;function Yt(e,t,r){const n=r;let i,o;for(let n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&56320==(64512&(o=e.charCodeAt(n+1)))?(i=65536+((1023&i)<<10)+(1023&o),++n,t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128);return r-n}function er(e,t){return RangeError(`index out of range: ${e.pos} + ${t??1} > ${e.len}`)}function tr(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}class rr{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(e){this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,er(this,10);return e}int32(){return 0|this.uint32()}sint32(){const e=this.uint32();return e>>>1^-(1&e)}bool(){return 0!==this.uint32()}fixed32(){if(this.pos+4>this.len)throw er(this,4);return tr(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw er(this,4);return 0|tr(this.buf,this.pos+=4)}float(){if(this.pos+4>this.len)throw er(this,4);const e=(t=this.buf,r=this.pos,jt[0]=t[r],jt[1]=t[r+1],jt[2]=t[r+2],jt[3]=t[r+3],Rt[0]);var t,r;return this.pos+=4,e}double(){if(this.pos+8>this.len)throw er(this,4);const e=(t=this.buf,r=this.pos,Jt[0]=t[r],Jt[1]=t[r+1],Jt[2]=t[r+2],Jt[3]=t[r+3],Jt[4]=t[r+4],Jt[5]=t[r+5],Jt[6]=t[r+6],Jt[7]=t[r+7],qt[0]);var t,r;return this.pos+=8,e}bytes(){const e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw er(this,e);return this.pos+=e,t===r?new Uint8Array(0):this.buf.subarray(t,r)}string(){const e=this.bytes();return function(e,t,r){if(r-t<1)return"";let n;const i=[];let o,s=0;for(;t<r;)o=e[t++],o<128?i[s++]=o:o>191&&o<224?i[s++]=(31&o)<<6|63&e[t++]:o>239&&o<365?(o=((7&o)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[s++]=55296+(o>>10),i[s++]=56320+(1023&o)):i[s++]=(15&o)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((n??(n=[])).push(String.fromCharCode.apply(String,i)),s=0);return null!=n?(s>0&&n.push(String.fromCharCode.apply(String,i.slice(0,s))),n.join("")):String.fromCharCode.apply(String,i.slice(0,s))}(e,0,e.length)}skip(e){if("number"==typeof e){if(this.pos+e>this.len)throw er(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw er(this)}while(128&this.buf[this.pos++]);return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${e} at offset ${this.pos}`)}return this}readLongVarint(){const e=new Kt(0,0);let t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw er(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw er(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw er(this,8);const e=tr(this.buf,this.pos+=4),t=tr(this.buf,this.pos+=4);return new Kt(e,t)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){const e=function(e,t){let r=e[t],n=0;if(n+=r&Ot,r<$t)return n;if(r=e[t+1],n+=(r&Ot)<<7,r<$t)return n;if(r=e[t+2],n+=(r&Ot)<<14,r<$t)return n;if(r=e[t+3],n+=(r&Ot)<<21,r<$t)return n;if(r=e[t+4],n+=(r&Ot)*Nt,r<$t)return n;if(r=e[t+5],n+=(r&Ot)*zt,r<$t)return n;if(r=e[t+6],n+=(r&Ot)*Lt,r<$t)return n;if(r=e[t+7],n+=(r&Ot)*Mt,r<$t)return n;throw new RangeError("Could not decode varint")}(this.buf,this.pos);return this.pos+=Ft(e),e}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}}function nr(e,t,r){const n=function(e){return new rr(e instanceof Uint8Array?e:e.subarray())}(e);return t.decode(n,void 0,r)}function ir(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function or(e=0){return null!=globalThis.Buffer?.allocUnsafe?ir(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function sr(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const ar=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*h+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,l=o-1;(0!==u||f<i)&&-1!==l;l--,f++)u+=a*s[l]>>>0,s[l]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),b=n;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=t[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var b=c.repeat(r);p<s;++p)b+=e.charAt(h[p]);return b},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class cr{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class hr{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return fr(this,e)}}class ur{decoders;constructor(e){this.decoders=e}or(e){return fr(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function fr(e,t){return new ur({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class lr{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new cr(e,t,r),this.decoder=new hr(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function dr({name:e,prefix:t,encode:r,decode:n}){return new lr(e,t,r,n)}function pr({name:e,prefix:t,alphabet:r}){const{encode:n,decode:i}=ar(r,e);return dr({prefix:t,name:e,encode:n,decode:e=>sr(i(e))})}function br({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return dr({prefix:t,name:e,encode:e=>function(e,t,r){const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,n,r),decode:t=>function(e,t,r,n){const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s}(t,n,r,e)})}const yr=pr({prefix:"9",name:"base10",alphabet:"0123456789"}),wr=br({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),gr=br({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),mr=br({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),vr=Array.from(""),xr=vr.reduce(((e,t,r)=>(e[r]=t,e)),[]),Ar=vr.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]),Er=dr({prefix:"",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+xr[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Ar[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),Cr=br({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),kr=br({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Sr=br({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),_r=br({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ur=br({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ir=br({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Tr=br({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Dr=br({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Br=br({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Pr=pr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Nr=pr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),zr=pr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Lr=pr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Mr=br({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$r=br({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Or=br({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Fr=br({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Vr=br({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Rr=dr({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>function(e){return(new TextEncoder).encode(e)}(e)}),jr=new TextEncoder,Hr=new TextDecoder,qr="json",Jr=512;function Gr(e){return jr.encode(JSON.stringify(e))}function Wr(e){return JSON.parse(Hr.decode(e))}const Qr="raw",Kr=85;function Xr(e){return sr(e)}function Zr(e){return sr(e)}var Yr=128,en=-128,tn=Math.pow(2,31),rn=128,nn=127,on=Math.pow(2,7),sn=Math.pow(2,14),an=Math.pow(2,21),cn=Math.pow(2,28),hn=Math.pow(2,35),un=Math.pow(2,42),fn=Math.pow(2,49),ln=Math.pow(2,56),dn=Math.pow(2,63);const pn={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=tn;)r[n++]=255&t|Yr,t/=128;for(;t&en;)r[n++]=255&t|Yr,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&nn)<<o:(n&nn)*Math.pow(2,o),o+=7}while(n>=rn);return e.bytes=s-r,i},encodingLength:function(e){return e<on?1:e<sn?2:e<an?3:e<cn?4:e<hn?5:e<un?6:e<fn?7:e<ln?8:e<dn?9:10}};function bn(e,t,r=0){return pn.encode(e,t,r),t}function yn(e){return pn.encodingLength(e)}function wn(e,t){const r=t.byteLength,n=yn(e),i=n+yn(r),o=new Uint8Array(i+r);return bn(e,o,0),bn(r,o,n),o.set(t,i),new gn(e,r,t,o)}class gn{code;size;digest;bytes;constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const mn=sr,vn={code:0,name:"identity",encode:mn,digest:function(e){return wn(0,mn(e))}};function xn({name:e,code:t,encode:r}){return new An(e,t,r)}class An{name;code;encode;constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?wn(this.code,t):t.then((e=>wn(this.code,e)))}throw Error("Unknown type, must be binary type")}}function En(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}const Cn=xn({name:"sha2-256",code:18,encode:En("SHA-256")}),kn=xn({name:"sha2-512",code:19,encode:En("SHA-512")});new WeakMap,Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const Sn={...l,...o,...f,...t,...i,...a,...c,...h,...u,...s};function _n(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Un=_n("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),In=_n("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=or((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Tn={utf8:Un,"utf-8":Un,hex:Sn.base16,latin1:In,ascii:In,binary:In,...Sn};class Dn{fn;len;next;val;constructor(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}}function Bn(){}class Pn{head;tail;len;next;constructor(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}}const Nn=function(e){const t=8192;let r,n=t;return function(e){if(e<1||e>4096)return or(e);n+e>t&&(r=or(t),n=0);const i=r.subarray(n,n+=e);return 7&n&&(n=1+(7|n)),i}}();class zn{len;head;tail;states;constructor(){this.len=0,this.head=new Dn(Bn,0,0),this.tail=this.head,this.states=null}_push(e,t,r){return this.tail=this.tail.next=new Dn(e,t,r),this.len+=t,this}uint32(e){return this.len+=(this.tail=this.tail.next=new $n((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(On,10,Kt.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){const t=Kt.fromBigInt(e);return this._push(On,t.length(),t)}uint64Number(e){return this._push(Vt,Ft(e),e)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){const t=Kt.fromBigInt(e).zzEncode();return this._push(On,t.length(),t)}sint64Number(e){const t=Kt.fromNumber(e).zzEncode();return this._push(On,t.length(),t)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(Ln,1,e?1:0)}fixed32(e){return this._push(Fn,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){const t=Kt.fromBigInt(e);return this._push(Fn,4,t.lo)._push(Fn,4,t.hi)}fixed64Number(e){const t=Kt.fromNumber(e);return this._push(Fn,4,t.lo)._push(Fn,4,t.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(Ht,4,e)}double(e){return this._push(Gt,8,e)}bytes(e){const t=e.length>>>0;return 0===t?this._push(Ln,1,0):this.uint32(t)._push(Vn,t,e)}string(e){const t=function(e){let t=0,r=0;for(let n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t}(e);return 0!==t?this.uint32(t)._push(Yt,t,e):this._push(Ln,1,0)}fork(){return this.states=new Pn(this),this.head=this.tail=new Dn(Bn,0,0),this.len=0,this}reset(){return null!=this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Dn(Bn,0,0),this.len=0),this}ldelim(){const e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),0!==r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this}finish(){let e=this.head.next;const t=(r=this.len,null!=globalThis.Buffer?or(r):Nn(r));var r;let n=0;for(;null!=e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t}}function Ln(e,t,r){t[r]=255&e}function Mn(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e}class $n extends Dn{next;constructor(e,t){super(Mn,e,t),this.next=void 0}}function On(e,t,r){for(;0!==e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function Fn(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Vn(e,t,r){t.set(e,r)}function Rn(e,t,r){t.set(e,r)}function jn(e,t,r){e.length<40?Yt(e,t,r):null!=t.utf8Write?t.utf8Write(e,r):t.set(function(e,t="utf8"){const r=Tn[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):ir(globalThis.Buffer.from(e,"utf-8"))}(e),r)}function Hn(e,t){const r=new zn;return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var qn,Jn,Gn,Wn;function Qn(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function Kn(e,t){return Qn("message",qn.LENGTH_DELIMITED,e,t)}null!=globalThis.Buffer&&(zn.prototype.bytes=function(e){const t=e.length>>>0;return this.uint32(t),t>0&&this._push(Rn,t,e),this},zn.prototype.string=function(e){const t=globalThis.Buffer.byteLength(e);return this.uint32(t),t>0&&this._push(jn,t,e),this}),function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"}(qn||(qn={})),Error,function(e){let t,r,n;!function(e){e.Raw="Raw",e.Directory="Directory",e.File="File",e.Metadata="Metadata",e.Symlink="Symlink",e.HAMTShard="HAMTShard"}(t=e.DataType||(e.DataType={})),function(e){e[e.Raw=0]="Raw",e[e.Directory=1]="Directory",e[e.File=2]="File",e[e.Metadata=3]="Metadata",e[e.Symlink=4]="Symlink",e[e.HAMTShard=5]="HAMTShard"}(r||(r={})),function(e){e.codec=()=>function(e){function t(t){if(null==e[t.toString()])throw new Error("Invalid enum value");return e[t]}return Qn("enum",qn.VARINT,(function(e,r){const n=t(e);r.int32(n)}),(function(e){return t(e.int32())}))}(r)}(t=e.DataType||(e.DataType={})),e.codec=()=>(null==n&&(n=Kn(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),null!=t.Type&&(r.uint32(8),e.DataType.codec().encode(t.Type,r)),null!=t.Data&&(r.uint32(18),r.bytes(t.Data)),null!=t.filesize&&(r.uint32(24),r.uint64(t.filesize)),null!=t.blocksizes)for(const e of t.blocksizes)r.uint32(32),r.uint64(e);null!=t.hashType&&(r.uint32(40),r.uint64(t.hashType)),null!=t.fanout&&(r.uint32(48),r.uint64(t.fanout)),null!=t.mode&&(r.uint32(56),r.uint32(t.mode)),null!=t.mtime&&(r.uint32(66),Gn.codec().encode(t.mtime,r)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={blocksizes:[]},i=null==r?t.len:t.pos+r;for(;t.pos<i;){const r=t.uint32();switch(r>>>3){case 1:n.Type=e.DataType.codec().decode(t);break;case 2:n.Data=t.bytes();break;case 3:n.filesize=t.uint64();break;case 4:n.blocksizes.push(t.uint64());break;case 5:n.hashType=t.uint64();break;case 6:n.fanout=t.uint64();break;case 7:n.mode=t.uint32();break;case 8:n.mtime=Gn.codec().decode(t,t.uint32());break;default:t.skipType(7&r)}}return n}))),n),e.encode=t=>Hn(t,e.codec()),e.decode=t=>nr(t,e.codec())}(Jn||(Jn={})),function(e){let t;e.codec=()=>(null==t&&(t=Kn(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Seconds&&(t.uint32(8),t.int64(e.Seconds)),null!=e.FractionalNanoseconds&&(t.uint32(21),t.fixed32(e.FractionalNanoseconds)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Seconds=e.int64();break;case 2:r.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Hn(t,e.codec()),e.decode=t=>nr(t,e.codec())}(Gn||(Gn={})),function(e){let t;e.codec=()=>(null==t&&(t=Kn(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.MimeType&&(t.uint32(10),t.string(e.MimeType)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();t>>>3==1?r.MimeType=e.string():e.skipType(7&t)}return r}))),t),e.encode=t=>Hn(t,e.codec()),e.decode=t=>nr(t,e.codec())}(Wn||(Wn={}));const Xn={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},Zn=["directory","hamt-sharded-directory"],Yn=parseInt("0644",8),ei=parseInt("0755",8);class ti{static unmarshal(e){const t=Jn.decode(e),r=new ti({type:Xn[null!=t.Type?t.Type.toString():"File"],data:t.Data,blockSizes:t.blocksizes,mode:t.mode,mtime:null!=t.mtime?{secs:t.mtime.Seconds??0n,nsecs:t.mtime.FractionalNanoseconds}:void 0,fanout:t.fanout});return r._originalMode=t.mode??0,r}type;data;blockSizes;hashType;fanout;mtime;_mode;_originalMode;constructor(e={type:"file"}){const{type:t,data:r,blockSizes:n,hashType:i,fanout:o,mtime:s,mode:a}=e;if(null!=t&&!Object.values(Xn).includes(t))throw oe(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t??"file",this.data=r,this.hashType=i,this.fanout=o,this.blockSizes=n??[],this._originalMode=0,this.mode=a,this.mtime=s}set mode(e){this._mode=null==e?this.isDirectory()?ei:Yn:4095&e}get mode(){return this._mode}isDirectory(){return Zn.includes(this.type)}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0n;let e=0n;return this.blockSizes.forEach((t=>{e+=t})),null!=this.data&&(e+=BigInt(this.data.length)),e}marshal(){let e;switch(this.type){case"raw":e=Jn.DataType.Raw;break;case"directory":e=Jn.DataType.Directory;break;case"file":e=Jn.DataType.File;break;case"metadata":e=Jn.DataType.Metadata;break;case"symlink":e=Jn.DataType.Symlink;break;case"hamt-sharded-directory":e=Jn.DataType.HAMTShard;break;default:throw oe(new Error(`Type: ${e} is not valid`),"ERR_INVALID_TYPE")}let t,r,n=this.data;return null!=this.data&&0!==this.data.length||(n=void 0),null!=this.mode&&(t=4294963200&this._originalMode|(this.mode??0),t!==Yn||this.isDirectory()||(t=void 0),t===ei&&this.isDirectory()&&(t=void 0)),null!=this.mtime&&(r={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),Jn.encode({Type:e,Data:n,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:t,mtime:r})}}function ri(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const ni="raw",ii=85;function oi(e){return ri(e)}function si(e){return ri(e)}class ai extends Event{constructor(e,t){super(e),this.detail=t}}const ci=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*h+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,l=o-1;(0!==u||f<i)&&-1!==l;l--,f++)u+=a*s[l]>>>0,s[l]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),b=n;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=t[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var b=c.repeat(r);p<s;++p)b+=e.charAt(h[p]);return b},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class hi{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ui{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return li(this,e)}}class fi{decoders;constructor(e){this.decoders=e}or(e){return li(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function li(e,t){return new fi({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class di{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new hi(e,t,r),this.decoder=new ui(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function pi({name:e,prefix:t,encode:r,decode:n}){return new di(e,t,r,n)}function bi({name:e,prefix:t,alphabet:r}){const{encode:n,decode:i}=ci(r,e);return pi({prefix:t,name:e,encode:n,decode:e=>ri(i(e))})}function yi({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return pi({prefix:t,name:e,encode:e=>function(e,t,r){const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,n,r),decode:t=>function(e,t,r,n){const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s}(t,n,r,e)})}const wi=yi({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),gi=yi({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mi=yi({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),vi=yi({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),xi=yi({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ai=yi({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ei=yi({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ci=yi({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ki=yi({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Si=bi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),_i=bi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ui=128,Ii=-128,Ti=Math.pow(2,31),Di=128,Bi=127,Pi=Math.pow(2,7),Ni=Math.pow(2,14),zi=Math.pow(2,21),Li=Math.pow(2,28),Mi=Math.pow(2,35),$i=Math.pow(2,42),Oi=Math.pow(2,49),Fi=Math.pow(2,56),Vi=Math.pow(2,63);const Ri={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Ti;)r[n++]=255&t|Ui,t/=128;for(;t&Ii;)r[n++]=255&t|Ui,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&Bi)<<o:(n&Bi)*Math.pow(2,o),o+=7}while(n>=Di);return e.bytes=s-r,i},encodingLength:function(e){return e<Pi?1:e<Ni?2:e<zi?3:e<Li?4:e<Mi?5:e<$i?6:e<Oi?7:e<Fi?8:e<Vi?9:10}};function ji(e,t=0){return[Ri.decode(e,t),Ri.decode.bytes]}function Hi(e,t,r=0){return Ri.encode(e,t,r),t}function qi(e){return Ri.encodingLength(e)}function Ji(e,t){const r=t.byteLength,n=qi(e),i=n+qi(r),o=new Uint8Array(i+r);return Hi(e,o,0),Hi(r,o,n),o.set(t,i),new Gi(e,r,t,o)}class Gi{code;size;digest;bytes;constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}function Wi(e,t){const{bytes:r,version:n}=e;return 0===n?function(e,t,r){const{prefix:n}=r;if(n!==Si.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i}(r,Ki(e),t??Si.encoder):function(e,t,r){const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i}(r,Ki(e),t??wi.encoder)}const Qi=new WeakMap;function Ki(e){const t=Qi.get(e);if(null==t){const t=new Map;return Qi.set(e,t),t}return t}class Xi{code;version;multihash;bytes;"/";constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Zi)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Yi)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Xi.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Ji(e,t);return Xi.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Xi.equals(this,e)}static equals(e,t){const r=t;return null!=r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}}(e.multihash,r.multihash)}toString(e){return Wi(this,e)}toJSON(){return{"/":Wi(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Xi)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new Xi(e,r,n,i??eo(e,r,n.bytes))}if(!0===t[to]){const{version:e,multihash:r,code:n}=t,i=function(e){const t=ri(e),[r,n]=ji(t),[i,o]=ji(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Gi(r,i,s,t)}(r);return Xi.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Zi)throw new Error(`Version 0 CID must use dag-pb (code: ${Zi}) block encoding`);return new Xi(e,t,r,r.bytes);case 1:{const n=eo(e,t,r.bytes);return new Xi(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Xi.create(0,Zi,e)}static createV1(e,t){return Xi.create(1,e,t)}static decode(e){const[t,r]=Xi.decodeFirst(e);if(0!==r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Xi.inspectBytes(e),r=t.size-t.multihashSize,n=ri(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new Gi(t.multihashCode,t.digestSize,i,n);return[0===t.version?Xi.createV0(o):Xi.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=ji(e.subarray(t));return t+=n,r};let n=r(),i=Zi;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=t,s=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[r,n]=function(e,t){switch(e[0]){case"Q":{const r=t??Si;return[Si.prefix,r.decode(`${Si.prefix}${e}`)]}case Si.prefix:{const r=t??Si;return[Si.prefix,r.decode(e)]}case wi.prefix:{const r=t??wi;return[wi.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}(e,t),i=Xi.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Ki(i).set(r,e),i}}const Zi=112,Yi=18;function eo(e,t,r){const n=qi(e),i=n+qi(t),o=new Uint8Array(i+r.byteLength);return Hi(e,o,0),Hi(t,o,n),o.set(r,i),o}const to=Symbol.for("@ipld/js-cid/CID");function ro({name:e,code:t,encode:r}){return new no(e,t,r)}class no{name;code;encode;constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ji(this.code,t):t.then((e=>Ji(this.code,e)))}throw Error("Unknown type, must be binary type")}}function io(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}const oo=ro({name:"sha2-256",code:18,encode:io("SHA-256")}),so=ro({name:"sha2-512",code:19,encode:io("SHA-512")}),ao=async(t,r,n)=>{null==n.codec&&(n.codec=e);const i=await oo.digest(t),o=Xi.create(n.cidVersion,n.codec.code,i);return await r.put(o,t,n),o};function co(t){return async function*(r,n){let i=0n;for await(let o of r.content)yield async()=>{let s;const a={codec:e,cidVersion:t.cidVersion,onProgress:t.onProgress};t.rawLeaves?(a.codec=w,a.cidVersion=1):(s=new ti({type:t.leafType,data:o}),o=It({Data:s.marshal(),Links:[]}));const c=await ao(o,n,a);return i+=BigInt(o.byteLength),t.onProgress?.(new ai("unixfs:importer:progress:file:write",{bytesWritten:i,cid:c,path:r.path})),{cid:c,unixfs:s,size:BigInt(o.length),block:o}}}}const ho=async(e,t,r)=>{const n=new ti({type:"directory",mtime:e.mtime,mode:e.mode}),i=It(Et({Data:n.marshal()}));return{cid:await ao(i,t,r),path:e.path,unixfs:n,size:BigInt(i.length),originalPath:e.originalPath,block:i}};function uo(e){return!0===e.single}const fo=async(e,t,r)=>r.layout(async function*(e,t,r){let n,i=-1;for await(const o of ce(r.bufferImporter(e,t),r.blockWriteConcurrency))i++,0!==i?(1===i&&null!=n&&(yield{...n,block:void 0,single:void 0},n=void 0),yield{...o,block:void 0}):n={...o,single:!0};null!=n&&(yield n)}(e,t,r),((e,t,r)=>async function(n){if(1===n.length&&uo(n[0])&&r.reduceSingleLeafToSelf){const i=n[0];let o=i.block;return!uo(i)||void 0===e.mtime&&void 0===e.mode||(i.unixfs=new ti({type:"file",mtime:e.mtime,mode:e.mode,data:i.block}),o={Data:i.unixfs.marshal(),Links:[]},i.block=It(Et(o)),i.cid=await ao(i.block,t,{...r,cidVersion:r.cidVersion}),i.size=BigInt(i.block.length)),r.onProgress?.(new ai("unixfs:importer:progress:file:layout",{cid:i.cid,path:i.originalPath})),{cid:i.cid,path:e.path,unixfs:i.unixfs,size:i.size,originalPath:i.originalPath}}const i=new ti({type:"file",mtime:e.mtime,mode:e.mode}),o=n.filter((e=>e.cid.code===ii&&e.size>0||null!=e.unixfs&&null==e.unixfs.data&&e.unixfs.fileSize()>0n||Boolean(e.unixfs?.data?.length))).map((e=>e.cid.code===ii?(i.addBlockSize(e.size),{Name:"",Tsize:Number(e.size),Hash:e.cid}):(null==e.unixfs||null==e.unixfs.data?i.addBlockSize(e.unixfs?.fileSize()??0n):i.addBlockSize(BigInt(e.unixfs.data.length)),{Name:"",Tsize:Number(e.size),Hash:e.cid}))),s={Data:i.marshal(),Links:o},a=It(Et(s)),c=await ao(a,t,r);return r.onProgress?.(new ai("unixfs:importer:progress:file:layout",{cid:c,path:e.originalPath})),{cid:c,path:e.path,unixfs:i,size:BigInt(a.length+s.Links.reduce(((e,t)=>e+(t.Tsize??0)),0)),originalPath:e.originalPath,block:a}})(e,t,r));function lo(e){try{if(e instanceof Uint8Array)return async function*(){yield e}();if(t=e,Symbol.iterator in t)return async function*(){yield*e}();if(function(e){return Symbol.asyncIterator in e}(e))return e}catch{throw oe(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}var t;throw oe(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}function po(e){return null!=e.content}function bo(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}const yo=bi({prefix:"9",name:"base10",alphabet:"0123456789"}),wo=yi({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),go=yi({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),mo=yi({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),vo=Array.from(""),xo=vo.reduce(((e,t,r)=>(e[r]=t,e)),[]),Ao=vo.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]),Eo=pi({prefix:"",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+xo[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Ao[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),Co=bi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ko=bi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),So=yi({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_o=yi({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Uo=yi({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Io=yi({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),To=yi({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Do=pi({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>function(e){return(new TextEncoder).encode(e)}(e)}),Bo=new TextEncoder,Po=new TextDecoder,No="json",zo=512;function Lo(e){return Bo.encode(JSON.stringify(e))}function Mo(e){return JSON.parse(Po.decode(e))}const $o=ri,Oo={code:0,name:"identity",encode:$o,digest:function(e){return Ji(0,$o(e))}},Fo={...U,...E,..._,...x,...A,...g,...k,...m,...S,...C};function Vo(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Ro=Vo("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),jo=Vo("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?bo(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Ho={utf8:Ro,"utf-8":Ro,hex:Fo.base16,latin1:jo,ascii:jo,binary:jo,...Fo};function qo(e,t="utf8"){const r=Ho[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):bo(globalThis.Buffer.from(e,"utf-8"))}const Jo=()=>async function*(e){for await(const t of e){if(void 0===t.length)throw oe(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if("string"==typeof t||t instanceof String)yield qo(t.toString());else if(Array.isArray(t))yield Uint8Array.from(t);else{if(!(t instanceof Uint8Array))throw oe(new Error("Content was invalid"),"ERR_INVALID_CONTENT");yield t}}},Go=174;function Wo(e){const t=e?.maxChildrenPerNode??Go;return async function e(r,n){const i=[];for await(const e of ae(r,t))i.push(await n(e));return i.length>1?e(i,n):i[0]}}class Qo{options;root;dir;path;dirty;flat;parent;parentKey;unixfs;mode;mtime;cid;size;nodeSize;constructor(e,t){this.options=t??{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime}}const Ko=Xi.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),Xo=Xi.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi");class Zo extends Qo{_children;constructor(e,t){super(e,t),this._children=new Map}async put(e,t){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,this._children.set(e,t)}async get(e){return Promise.resolve(this._children.get(e))}childCount(){return this._children.size}directChildrenCount(){return this.childCount()}onlyChild(){return this._children.values().next().value}async*eachChildSeries(){for(const[e,t]of this._children.entries())yield{key:e,child:t}}estimateNodeSize(){if(void 0!==this.nodeSize)return this.nodeSize;this.nodeSize=0;for(const[e,t]of this._children.entries())null!=t.size&&null!=t.cid&&(this.nodeSize+=e.length+(1===this.options.cidVersion?Xo.bytes.byteLength:Ko.bytes.byteLength));return this.nodeSize}async*flush(e){const t=[];for(const[r,n]of this._children.entries()){let i=n;if(n instanceof Qo)for await(const t of n.flush(e))i=t,yield t;null!=i.size&&null!=i.cid&&t.push({Name:r,Tsize:Number(i.size),Hash:i.cid})}const r=new ti({type:"directory",mtime:this.mtime,mode:this.mode}),n={Data:r.marshal(),Links:t},i=It(Et(n)),o=await ao(i,e,this.options),s=i.length+n.Links.reduce(((e,t)=>e+(null==t.Tsize?0:t.Tsize)),0);this.cid=o,this.size=s,yield{cid:o,unixfs:r,path:this.path,size:BigInt(s)}}}const Yo=new Uint8Array(0);function es(e){const t=e.match(/../g);return null!=t?new Uint8Array(t.map((e=>parseInt(e,16)))):Yo}const ts=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*h+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,l=o-1;(0!==u||f<i)&&-1!==l;l--,f++)u+=a*s[l]>>>0,s[l]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),b=n;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=t[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var b=c.repeat(r);p<s;++p)b+=e.charAt(h[p]);return b},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class rs{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ns{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return os(this,e)}}class is{decoders;constructor(e){this.decoders=e}or(e){return os(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function os(e,t){return new is({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class ss{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new rs(e,t,r),this.decoder=new ns(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function as({name:e,prefix:t,encode:r,decode:n}){return new ss(e,t,r,n)}function cs({name:e,prefix:t,alphabet:r}){const{encode:n,decode:i}=ts(r,e);return as({prefix:t,name:e,encode:n,decode:e=>function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}(i(e))})}function hs({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return as({prefix:t,name:e,encode:e=>function(e,t,r){const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,n,r),decode:t=>function(e,t,r,n){const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s}(t,n,r,e)})}hs({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),hs({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),hs({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hs({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),hs({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hs({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),hs({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),hs({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hs({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),cs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),cs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var us=128,fs=-128,ls=Math.pow(2,31),ds=128,ps=127,bs=Math.pow(2,7),ys=Math.pow(2,14),ws=Math.pow(2,21),gs=Math.pow(2,28),ms=Math.pow(2,35),vs=Math.pow(2,42),xs=Math.pow(2,49),As=Math.pow(2,56),Es=Math.pow(2,63);const Cs={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=ls;)r[n++]=255&t|us,t/=128;for(;t&fs;)r[n++]=255&t|us,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&ps)<<o:(n&ps)*Math.pow(2,o),o+=7}while(n>=ds);return e.bytes=s-r,i},encodingLength:function(e){return e<bs?1:e<ys?2:e<ws?3:e<gs?4:e<ms?5:e<vs?6:e<xs?7:e<As?8:e<Es?9:10}};function ks(e,t,r=0){return Cs.encode(e,t,r),t}function Ss(e){return Cs.encodingLength(e)}function _s(e,t){const r=t.byteLength,n=Ss(e),i=n+Ss(r),o=new Uint8Array(i+r);return ks(e,o,0),ks(r,o,n),o.set(t,i),new Us(e,r,t,o)}class Us{code;size;digest;bytes;constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}function Is({name:e,code:t,encode:r}){return new Ts(e,t,r)}new WeakMap,Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");class Ts{name;code;encode;constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?_s(this.code,t):t.then((e=>_s(this.code,e)))}throw Error("Unknown type, must be binary type")}}var Ds=r(437);Is({name:"murmur3-32",code:35,encode:e=>function(e){const t=new Array(4);for(let r=0;r<4;r++)t[r]=255&e,e>>=8;return new Uint8Array(t)}(Ds.x86.hash32(e))});const Bs=Is({name:"murmur3-128",code:34,encode:e=>es(Ds.x64.hash128(e))});Is({name:"murmur3-x64-64",code:34,encode:e=>es(Ds.x64.hash128(e)).subarray(0,8)});var Ps=r(669);function Ns(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function zs(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const Ls=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*h+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,l=o-1;(0!==u||f<i)&&-1!==l;l--,f++)u+=a*s[l]>>>0,s[l]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),b=n;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=t[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var b=c.repeat(r);p<s;++p)b+=e.charAt(h[p]);return b},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class Ms{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class $s{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Fs(this,e)}}class Os{decoders;constructor(e){this.decoders=e}or(e){return Fs(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function Fs(e,t){return new Os({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class Vs{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Ms(e,t,r),this.decoder=new $s(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function Rs({name:e,prefix:t,encode:r,decode:n}){return new Vs(e,t,r,n)}function js({name:e,prefix:t,alphabet:r}){const{encode:n,decode:i}=Ls(r,e);return Rs({prefix:t,name:e,encode:n,decode:e=>zs(i(e))})}function Hs({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return Rs({prefix:t,name:e,encode:e=>function(e,t,r){const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,n,r),decode:t=>function(e,t,r,n){const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s}(t,n,r,e)})}const qs=js({prefix:"9",name:"base10",alphabet:"0123456789"}),Js=Hs({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Gs=Hs({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Ws=Hs({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Qs=Array.from(""),Ks=Qs.reduce(((e,t,r)=>(e[r]=t,e)),[]),Xs=Qs.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]),Zs=Rs({prefix:"",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+Ks[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Xs[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),Ys=Hs({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ea=Hs({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ta=Hs({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ra=Hs({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),na=Hs({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ia=Hs({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),oa=Hs({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),sa=Hs({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),aa=Hs({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ca=js({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ha=js({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),ua=js({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),fa=js({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),la=Hs({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),da=Hs({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),pa=Hs({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ba=Hs({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ya=Hs({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),wa=Rs({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>function(e){return(new TextEncoder).encode(e)}(e)}),ga=new TextEncoder,ma=new TextDecoder,va="json",xa=512;function Aa(e){return ga.encode(JSON.stringify(e))}function Ea(e){return JSON.parse(ma.decode(e))}const Ca="raw",ka=85;function Sa(e){return zs(e)}function _a(e){return zs(e)}var Ua=128,Ia=-128,Ta=Math.pow(2,31),Da=128,Ba=127,Pa=Math.pow(2,7),Na=Math.pow(2,14),za=Math.pow(2,21),La=Math.pow(2,28),Ma=Math.pow(2,35),$a=Math.pow(2,42),Oa=Math.pow(2,49),Fa=Math.pow(2,56),Va=Math.pow(2,63);const Ra={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Ta;)r[n++]=255&t|Ua,t/=128;for(;t&Ia;)r[n++]=255&t|Ua,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&Ba)<<o:(n&Ba)*Math.pow(2,o),o+=7}while(n>=Da);return e.bytes=s-r,i},encodingLength:function(e){return e<Pa?1:e<Na?2:e<za?3:e<La?4:e<Ma?5:e<$a?6:e<Oa?7:e<Fa?8:e<Va?9:10}};function ja(e,t,r=0){return Ra.encode(e,t,r),t}function Ha(e){return Ra.encodingLength(e)}function qa(e,t){const r=t.byteLength,n=Ha(e),i=n+Ha(r),o=new Uint8Array(i+r);return ja(e,o,0),ja(r,o,n),o.set(t,i),new Ja(e,r,t,o)}class Ja{code;size;digest;bytes;constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Ga=zs,Wa={code:0,name:"identity",encode:Ga,digest:function(e){return qa(0,Ga(e))}};function Qa({name:e,code:t,encode:r}){return new Ka(e,t,r)}class Ka{name;code;encode;constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?qa(this.code,t):t.then((e=>qa(this.code,e)))}throw Error("Unknown type, must be binary type")}}function Xa(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}const Za=Qa({name:"sha2-256",code:18,encode:Xa("SHA-256")}),Ya=Qa({name:"sha2-512",code:19,encode:Xa("SHA-512")});new WeakMap,Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const ec={...F,...P,...O,...D,...B,...z,...L,...M,...$,...N};function tc(e=0){return null!=globalThis.Buffer?.allocUnsafe?Ns(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function rc(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const nc=rc("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),ic=rc("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=tc((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),oc={utf8:nc,"utf-8":nc,hex:ec.base16,latin1:ic,ascii:ic,binary:ic,...ec};class sc{_options;_popCount;_parent;_posAtParent;_children;key;constructor(e,t,r=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=r,this._children=new Ps,this.key=null}async put(e,t){const r=await this._findNewBucketAndPos(e);r.bucket._putAt(r,e,t)}async get(e){const t=await this._findChild(e);if(null!=t)return t.value}async del(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);null!=r&&r.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce(((e,t)=>t instanceof sc?e+t.leafCount():e+1),0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)t instanceof sc?yield*t.eachLeafSeries():yield t}serialize(e,t){return t(this._children.reduce(((r,n,i)=>(null!=n&&(n instanceof sc?r.push(n.serialize(e,t)):r.push(e(n,i))),r)),[]))}async asyncTransform(e,t){return uc(this,e,t)}toJSON(){return this.serialize(cc,hc)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);if(!(r instanceof sc))return null!=r&&r.key===e?r:void 0}async _findPlace(e){const t=this._options.hash("string"==typeof e?function(e,t="utf8"){const r=oc[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Ns(globalThis.Buffer.from(e,"utf-8"))}(e):e),r=await t.take(this._options.bits),n=this._children.get(r);return n instanceof sc?n._findPlace(t):{bucket:this,pos:r,hash:t,existingChild:n}}async _findNewBucketAndPos(e){const t=await this._findPlace(e);if(null!=t.existingChild&&t.existingChild.key!==e){const e=new sc(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,e);const r=await e._findPlace(t.existingChild.hash);return r.bucket._putAt(r,t.existingChild.key,t.existingChild.value),e._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,r){this._putObjectAt(e.pos,{key:t,value:r,hash:e.hash})}_putObjectAt(e,t){null==this._children.get(e)&&this._popCount++,this._children.set(e,t)}_delAt(e){if(-1===e)throw new Error("Invalid position");null!=this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(null!=this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(ac);if(null!=e&&!(e instanceof sc)){const t=e.hash;t.untake(this._options.bits);const r={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(r,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function ac(e){return Boolean(e)}function cc(e,t){return e.key}function hc(e){return e}async function uc(e,t,r){const n=[];for(const i of e._children.compactArray())if(i instanceof sc)await uc(i,t,r);else{const r=await t(i);n.push({bitField:e._children.bitField(),children:r})}return r(n)}const fc=[255,254,252,248,240,224,192,128],lc=[1,3,7,15,31,63,127,255];class dc{_value;_currentBytePos;_currentBitPos;constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,r=0;for(;t>0&&this._haveBits();){const e=this._value[this._currentBytePos],n=this._currentBitPos+1,i=Math.min(n,t);r=(r<<i)+pc(e,n-i,i),t-=i,this._currentBitPos-=i,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function pc(e,t,r){const n=function(e,t){return fc[e]&lc[Math.min(t+e-1,7)]}(t,r);return(e&n)>>>t}function bc(e){return function(t){return t instanceof yc?t:new yc(t,e)}}class yc{_value;_hashFn;_depth;_availableBits;_currentBufferIndex;_buffers;constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let r=0;for(;t>0;){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.availableBits(),t);r=(r<<n)+e.take(n),t-=n,this._availableBits-=n,0===e.availableBits()&&this._currentBufferIndex++}return r}untake(e){let t=e;for(;t>0;){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.totalBits()-e.availableBits(),t);e.untake(r),t-=r,this._availableBits+=r,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth>0?function(e,t){if(null!=globalThis.Buffer)return Ns(globalThis.Buffer.concat(e,t));null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=tc(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return Ns(r)}([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),r=new dc(t);this._buffers.push(r),this._availableBits+=r.availableBits()}}function wc(e){if(null==e||null==e.hashFn)throw new Error("please define an options.hashFn");const t={bits:e.bits??8,hash:bc(e.hashFn)};return new sc(t)}async function gc(e){return(await Bs.encode(e)).slice(0,8).reverse()}const mc=BigInt(34),vc=class extends Qo{_bucket;constructor(e,t){super(e,t),this._bucket=wc({hashFn:gc,bits:t.shardFanoutBits??8})}async put(e,t){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(e,t)}async get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}estimateNodeSize(){return void 0!==this.nodeSize||(this.nodeSize=Ac(this._bucket,this,this.options)),this.nodeSize}async*flush(e){for await(const t of xc(this._bucket,e,this,this.options))yield{...t,path:this.path}}};async function*xc(e,t,r,n){const i=e._children,o=(e.tableSize()-1).toString(16).length,s=[];let a=0n;for(let e=0;e<i.length;e++){const r=i.get(e);if(null==r)continue;const c=e.toString(16).toUpperCase().padStart(o,"0");if(r instanceof sc){let e;for await(const i of xc(r,t,null,n))e=i;if(null==e)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:c,Tsize:Number(e.size),Hash:e.cid}),a+=e.size}else if("function"==typeof r.value.flush){const e=r.value;let n;for await(const r of e.flush(t))n=r,yield n;if(null==n)throw new Error("Did not flush dir");const i=c+r.key;s.push({Name:i,Tsize:Number(n.size),Hash:n.cid}),a+=n.size}else{const e=r.value;if(null==e.cid)continue;const t=c+r.key,n=e.size;s.push({Name:t,Tsize:Number(n),Hash:e.cid}),a+=BigInt(n??0)}}const c=Uint8Array.from(i.bitField().reverse()),h=new ti({type:"hamt-sharded-directory",data:c,fanout:BigInt(e.tableSize()),hashType:mc,mtime:r?.mtime,mode:r?.mode}),u=It(Et({Data:h.marshal(),Links:s})),f=await ao(u,t,n),l=BigInt(u.byteLength)+a;yield{cid:f,unixfs:h,size:l}}function Ac(e,t,r){const n=e._children,i=(e.tableSize()-1).toString(16).length,o=[];for(let e=0;e<n.length;e++){const t=n.get(e);if(null==t)continue;const s=e.toString(16).toUpperCase().padStart(i,"0");if(t instanceof sc){const e=Ac(t,null,r);o.push({Name:s,Tsize:Number(e),Hash:0===r.cidVersion?Ko:Xo})}else if("function"==typeof t.value.flush){const e=t.value.nodeSize();o.push({Name:s+t.key,Tsize:Number(e),Hash:0===r.cidVersion?Ko:Xo})}else{const e=t.value;if(null==e.cid)continue;const r=s+t.key,n=e.size;o.push({Name:r,Tsize:Number(n),Hash:e.cid})}}const s=Uint8Array.from(n.bitField().reverse());return It(Et({Data:new ti({type:"hamt-sharded-directory",data:s,fanout:BigInt(e.tableSize()),hashType:mc,mtime:t?.mtime,mode:t?.mode}).marshal(),Links:o})).length}async function Ec(e,t,r,n){let i=t;t instanceof Zo&&t.estimateNodeSize()>r&&(i=await async function(e,t){const r=new vc({root:e.root,dir:!0,parent:e.parent,parentKey:e.parentKey,path:e.path,dirty:e.dirty,flat:!1,mtime:e.mtime,mode:e.mode},t);for await(const{key:t,child:n}of e.eachChildSeries())await r.put(t,n);return r}(t,n));const o=i.parent;if(null!=o){if(i!==t){if(null!=e&&(e.parent=i),null==i.parentKey)throw new Error("No parent key found");await o.put(i.parentKey,i)}return Ec(i,o,r,n)}return i}const Cc=(e="")=>e.split(/(?<!\\)\//).filter(Boolean);async function kc(e,t,r){const n=Cc(e.path??""),i=n.length-1;let o=t,s="";for(let a=0;a<n.length;a++){const c=n[a];s+=`${""!==s?"/":""}${c}`;const h=a===i;if(o.dirty=!0,o.cid=void 0,o.size=void 0,h)await o.put(c,e),t=await Ec(null,o,r.shardSplitThresholdBytes,r);else{let e=await o.get(c);null!=e&&e instanceof Qo||(e=new Zo({root:!1,dir:!0,parent:o,parentKey:c,path:s,dirty:!0,flat:!0,mtime:e?.unixfs?.mtime,mode:e?.unixfs?.mode},r)),await o.put(c,e),o=e}}return t}async function*Sc(e,t){e instanceof Qo?yield*e.flush(t):!0===e.unixfs?.isDirectory()&&(yield e)}async function*_c(e,t,r={}){let n;n=Symbol.asyncIterator in e||Symbol.iterator in e?e:[e];const i=r.wrapWithDirectory??!1,o=r.shardSplitThresholdBytes??262144,s=r.shardFanoutBits??8,a=r.cidVersion??1,c=r.rawLeaves??!0,h=r.leafType??"file",u=r.fileImportConcurrency??50,f=r.blockWriteConcurrency??10,l=r.reduceSingleLeafToSelf??!0,d=r.chunker??ge(),p=r.chunkValidator??Jo(),b=r.dagBuilder??function(e){return async function*(t,r){for await(const n of t){let t;if(null!=n.path&&(t=n.path,n.path=n.path.split("/").filter((e=>null!=e&&"."!==e)).join("/")),po(n)){const i={path:n.path,mtime:n.mtime,mode:n.mode,content:async function*(){let t=0n;for await(const r of e.chunker(e.chunkValidator(lo(n.content)))){const i=BigInt(r.byteLength);t+=i,e.onProgress?.(new ai("unixfs:importer:progress:file:read",{bytesRead:t,chunkSize:i,path:n.path})),yield r}}(),originalPath:t};yield async()=>fo(i,r,e)}else{if(null==n.path)throw new Error("Import candidate must have content or path or both");{const i={path:n.path,mtime:n.mtime,mode:n.mode,originalPath:t};yield async()=>ho(i,r,e)}}}}}({chunker:d,chunkValidator:p,wrapWithDirectory:i,layout:r.layout??Wo(),bufferImporter:r.bufferImporter??co({cidVersion:a,rawLeaves:c,leafType:h,onProgress:r.onProgress}),blockWriteConcurrency:f,reduceSingleLeafToSelf:l,cidVersion:a,onProgress:r.onProgress}),y=r.treeBuilder??function(e){return async function*(t,r){let n,i=new Zo({root:!0,dir:!0,path:"",dirty:!0,flat:!0},e),o=!1;for await(const r of t){if(null==r)continue;const t=`${r.originalPath??""}`.split("/")[0];null!=t&&""!==t&&(null==n?(n=t,o=!0):n!==t&&(o=!1)),i=await kc(r,i,e),null!=r.unixfs&&r.unixfs.isDirectory()||(yield r)}if(e.wrapWithDirectory||o&&i.childCount()>1)yield*Sc(i,r);else for await(const e of i.eachChildSeries())null!=e&&(yield*Sc(e.child,r))}}({wrapWithDirectory:i,shardSplitThresholdBytes:o,shardFanoutBits:s,cidVersion:a,onProgress:r.onProgress});for await(const e of y(ce(b(n,t),u),t))yield{cid:e.cid,path:e.path,unixfs:e.unixfs,size:e.size}}async function Uc(e,t,r={}){const n=await se(_c([e],t,r));if(null==n)throw oe(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return n}r(942);const Ic={cidVersion:1,rawLeaves:!0,layout:Wo({maxChildrenPerNode:1024}),chunker:ge({chunkSize:1048576})};const Tc=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{let t;for await(const r of e)t=r;return t})();let t;for(const r of e)t=r;return t};function Dc(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const Bc=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*h+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,l=o-1;(0!==u||f<i)&&-1!==l;l--,f++)u+=a*s[l]>>>0,s[l]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),b=n;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=t[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var b=c.repeat(r);p<s;++p)b+=e.charAt(h[p]);return b},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class Pc{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Nc{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Lc(this,e)}}class zc{decoders;constructor(e){this.decoders=e}or(e){return Lc(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function Lc(e,t){return new zc({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class Mc{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Pc(e,t,r),this.decoder=new Nc(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function $c({name:e,prefix:t,encode:r,decode:n}){return new Mc(e,t,r,n)}function Oc({name:e,prefix:t,alphabet:r}){const{encode:n,decode:i}=Bc(r,e);return $c({prefix:t,name:e,encode:n,decode:e=>Dc(i(e))})}function Fc({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return $c({prefix:t,name:e,encode:e=>function(e,t,r){const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,n,r),decode:t=>function(e,t,r,n){const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s}(t,n,r,e)})}const Vc=Fc({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Rc=(Fc({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Fc({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Fc({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Fc({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Fc({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Fc({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Fc({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Fc({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Oc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));Oc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var jc=128,Hc=-128,qc=Math.pow(2,31),Jc=128,Gc=127,Wc=Math.pow(2,7),Qc=Math.pow(2,14),Kc=Math.pow(2,21),Xc=Math.pow(2,28),Zc=Math.pow(2,35),Yc=Math.pow(2,42),eh=Math.pow(2,49),th=Math.pow(2,56),rh=Math.pow(2,63);const nh={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=qc;)r[n++]=255&t|jc,t/=128;for(;t&Hc;)r[n++]=255&t|jc,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&Gc)<<o:(n&Gc)*Math.pow(2,o),o+=7}while(n>=Jc);return e.bytes=s-r,i},encodingLength:function(e){return e<Wc?1:e<Qc?2:e<Kc?3:e<Xc?4:e<Zc?5:e<Yc?6:e<eh?7:e<th?8:e<rh?9:10}};function ih(e,t=0){return[nh.decode(e,t),nh.decode.bytes]}function oh(e,t,r=0){return nh.encode(e,t,r),t}function sh(e){return nh.encodingLength(e)}function ah(e){const t=Dc(e),[r,n]=ih(t),[i,o]=ih(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new ch(r,i,s,t)}class ch{code;size;digest;bytes;constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}function hh(e,t){const{bytes:r,version:n}=e;return 0===n?function(e,t,r){const{prefix:n}=r;if(n!==Rc.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i}(r,fh(e),t??Rc.encoder):function(e,t,r){const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i}(r,fh(e),t??Vc.encoder)}const uh=new WeakMap;function fh(e){const t=uh.get(e);if(null==t){const t=new Map;return uh.set(e,t),t}return t}class lh{code;version;multihash;bytes;"/";constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==dh)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==ph)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return lh.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=function(e,t){const r=t.byteLength,n=sh(e),i=n+sh(r),o=new Uint8Array(i+r);return oh(e,o,0),oh(r,o,n),o.set(t,i),new ch(e,r,t,o)}(e,t);return lh.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return lh.equals(this,e)}static equals(e,t){const r=t;return null!=r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}}(e.multihash,r.multihash)}toString(e){return hh(this,e)}toJSON(){return{"/":hh(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof lh)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new lh(e,r,n,i??bh(e,r,n.bytes))}if(!0===t[yh]){const{version:e,multihash:r,code:n}=t,i=ah(r);return lh.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==dh)throw new Error(`Version 0 CID must use dag-pb (code: ${dh}) block encoding`);return new lh(e,t,r,r.bytes);case 1:{const n=bh(e,t,r.bytes);return new lh(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return lh.create(0,dh,e)}static createV1(e,t){return lh.create(1,e,t)}static decode(e){const[t,r]=lh.decodeFirst(e);if(0!==r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=lh.inspectBytes(e),r=t.size-t.multihashSize,n=Dc(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new ch(t.multihashCode,t.digestSize,i,n);return[0===t.version?lh.createV0(o):lh.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=ih(e.subarray(t));return t+=n,r};let n=r(),i=dh;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=t,s=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[r,n]=function(e,t){switch(e[0]){case"Q":{const r=t??Rc;return[Rc.prefix,r.decode(`${Rc.prefix}${e}`)]}case Rc.prefix:{const r=t??Rc;return[Rc.prefix,r.decode(e)]}case Vc.prefix:{const r=t??Vc;return[Vc.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}(e,t),i=lh.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return fh(i).set(r,e),i}}const dh=112,ph=18;function bh(e,t,r){const n=sh(e),i=n+sh(t),o=new Uint8Array(i+r.byteLength);return oh(e,o,0),oh(t,o,n),o.set(r,i),o}const yh=Symbol.for("@ipld/js-cid/CID"),wh=["string","number","bigint","symbol"],gh=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];class mh{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}mh.uint=new mh(0,"uint",!0),mh.negint=new mh(1,"negint",!0),mh.bytes=new mh(2,"bytes",!0),mh.string=new mh(3,"string",!0),mh.array=new mh(4,"array",!1),mh.map=new mh(5,"map",!1),mh.tag=new mh(6,"tag",!1),mh.float=new mh(7,"float",!0),mh.false=new mh(7,"false",!0),mh.true=new mh(7,"true",!0),mh.null=new mh(7,"null",!0),mh.undefined=new mh(7,"undefined",!0),mh.break=new mh(7,"break",!0);class vh{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const xh=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,Ah=new TextDecoder,Eh=new TextEncoder;function Ch(e){return xh&&globalThis.Buffer.isBuffer(e)}const kh=xh?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):Dh(e,t,r):(e,t,r)=>r-t>64?Ah.decode(e.subarray(t,r)):Dh(e,t,r),Sh=xh?e=>e.length>64?globalThis.Buffer.from(e):Th(e):e=>e.length>64?Eh.encode(e):Th(e),_h=xh?(e,t,r)=>Ch(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),Uh=xh?(e,t)=>{return e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),(r=globalThis.Buffer.concat(e,t))instanceof Uint8Array?Ch(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r);var r}:(e,t)=>{const r=new Uint8Array(t);let n=0;for(let t of e)n+t.length>r.length&&(t=t.subarray(0,r.length-n)),r.set(t,n),n+=t.length;return r},Ih=xh?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Th(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&n+1<e.length&&56320==(64512&e.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128)}return t}function Dh(e,t,r){const n=[];for(;t<r;){const i=e[t];let o=null,s=i>239?4:i>223?3:i>191?2:1;if(t+s<=r){let r,n,a,c;switch(s){case 1:i<128&&(o=i);break;case 2:r=e[t+1],128==(192&r)&&(c=(31&i)<<6|63&r,c>127&&(o=c));break;case 3:r=e[t+1],n=e[t+2],128==(192&r)&&128==(192&n)&&(c=(15&i)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:r=e[t+1],n=e[t+2],a=e[t+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&i)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),t+=s}return Ph(n)}const Bh=4096;function Ph(e){const t=e.length;if(t<=Bh)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Bh));return r}const Nh="CBOR decode error:",zh="CBOR encode error:",Lh=[];function Mh(e,t,r){if(e.length-t<r)throw new Error(`${Nh} not enough data for type`)}Lh[23]=1,Lh[24]=2,Lh[25]=3,Lh[26]=5,Lh[27]=9;const $h=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Oh(e,t,r){Mh(e,t,1);const n=e[t];if(!0===r.strict&&n<$h[0])throw new Error(`${Nh} integer encoded in more bytes than necessary (strict decode)`);return n}function Fh(e,t,r){Mh(e,t,2);const n=e[t]<<8|e[t+1];if(!0===r.strict&&n<$h[1])throw new Error(`${Nh} integer encoded in more bytes than necessary (strict decode)`);return n}function Vh(e,t,r){Mh(e,t,4);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&n<$h[2])throw new Error(`${Nh} integer encoded in more bytes than necessary (strict decode)`);return n}function Rh(e,t,r){Mh(e,t,8);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(!0===r.strict&&o<$h[3])throw new Error(`${Nh} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(!0===r.allowBigInt)return o;throw new Error(`${Nh} integers outside of the safe integer range are not supported`)}function jh(e,t){return Hh(e,0,t.value)}function Hh(e,t,r){if(r<$h[0]){const n=Number(r);e.push([t|n])}else if(r<$h[1]){const n=Number(r);e.push([24|t,n])}else if(r<$h[2]){const n=Number(r);e.push([25|t,n>>>8,255&n])}else if(r<$h[3]){const n=Number(r);e.push([26|t,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<$h[4]))throw new Error(`${Nh} encountered BigInt larger than allowable range`);{const r=[27|t,0,0,0,0,0,0,0];let i=Number(n&BigInt(4294967295)),o=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&i,i>>=8,r[7]=255&i,i>>=8,r[6]=255&i,i>>=8,r[5]=255&i,r[4]=255&o,o>>=8,r[3]=255&o,o>>=8,r[2]=255&o,o>>=8,r[1]=255&o,e.push(r)}}}jh.encodedSize=function(e){return Hh.encodedSize(e.value)},Hh.encodedSize=function(e){return e<$h[0]?1:e<$h[1]?2:e<$h[2]?3:e<$h[3]?5:9},jh.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const qh=BigInt(-1),Jh=BigInt(1);function Gh(e,t){const r=t.value,n="bigint"==typeof r?r*qh-Jh:-1*r-1;Hh(e,t.type.majorEncoded,n)}function Wh(e,t,r,n){Mh(e,t,r+n);const i=_h(e,t+r,t+r+n);return new vh(mh.bytes,i,r+n)}function Qh(e,t,r,n){return Wh(e,t,1,r)}function Kh(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===mh.string?Sh(e.value):e.value),e.encodedBytes}function Xh(e,t){const r=Kh(t);Hh(e,t.type.majorEncoded,r.length),e.push(r)}function Zh(e,t,r,n,i){const o=r+n;Mh(e,t,o);const s=new vh(mh.string,kh(e,t+r,t+o),o);return!0===i.retainStringBytes&&(s.byteValue=_h(e,t+r,t+o)),s}function Yh(e,t,r,n){return Zh(e,t,1,r,n)}Gh.encodedSize=function(e){const t=e.value,r="bigint"==typeof t?t*qh-Jh:-1*t-1;return r<$h[0]?1:r<$h[1]?2:r<$h[2]?3:r<$h[3]?5:9},Gh.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},Xh.encodedSize=function(e){const t=Kh(e);return Hh.encodedSize(t.length)+t.length},Xh.compareTokens=function(e,t){return r=Kh(e),n=Kh(t),r.length<n.length?-1:r.length>n.length?1:function(e,t){if(Ch(e)&&Ch(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}(r,n);var r,n};const eu=Xh;function tu(e,t,r,n){return new vh(mh.array,n,r)}function ru(e,t,r,n){return tu(0,0,1,r)}function nu(e,t){Hh(e,mh.array.majorEncoded,t.value)}function iu(e,t,r,n){return new vh(mh.map,n,r)}function ou(e,t,r,n){return iu(0,0,1,r)}function su(e,t){Hh(e,mh.map.majorEncoded,t.value)}function au(e,t,r,n){return new vh(mh.tag,r,1)}function cu(e,t){Hh(e,mh.tag.majorEncoded,t.value)}nu.compareTokens=jh.compareTokens,nu.encodedSize=function(e){return Hh.encodedSize(e.value)},su.compareTokens=jh.compareTokens,su.encodedSize=function(e){return Hh.encodedSize(e.value)},cu.compareTokens=jh.compareTokens,cu.encodedSize=function(e){return Hh.encodedSize(e.value)};function hu(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error(`${Nh} NaN values are not supported`);if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${Nh} Infinity values are not supported`)}return new vh(mh.float,e,t)}function uu(e,t,r){const n=t.value;if(!1===n)e.push([20|mh.float.majorEncoded]);else if(!0===n)e.push([21|mh.float.majorEncoded]);else if(null===n)e.push([22|mh.float.majorEncoded]);else if(void 0===n)e.push([23|mh.float.majorEncoded]);else{let t,o=!1;r&&!0===r.float64||(pu(n),t=bu(du,1),n===t||Number.isNaN(n)?(du[0]=249,e.push(du.slice(0,3)),o=!0):(yu(n),t=wu(du,1),n===t&&(du[0]=250,e.push(du.slice(0,5)),o=!0))),o||(i=n,lu.setFloat64(0,i,!1),t=gu(du,1),du[0]=251,e.push(du.slice(0,9)))}var i}uu.encodedSize=function(e,t){const r=e.value;if(!1===r||!0===r||null==r)return 1;if(!t||!0!==t.float64){pu(r);let e=bu(du,1);if(r===e||Number.isNaN(r))return 3;if(yu(r),e=wu(du,1),r===e)return 5}return 9};const fu=new ArrayBuffer(9),lu=new DataView(fu,1),du=new Uint8Array(fu,0);function pu(e){if(e===1/0)lu.setUint16(0,31744,!1);else if(e===-1/0)lu.setUint16(0,64512,!1);else if(Number.isNaN(e))lu.setUint16(0,32256,!1);else{lu.setFloat32(0,e);const t=lu.getUint32(0),r=(2139095040&t)>>23,n=8388607&t;if(255===r)lu.setUint16(0,31744,!1);else if(0===r)lu.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{const e=r-127;e<-24?lu.setUint16(0,0):e<-14?lu.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):lu.setUint16(0,(2147483648&t)>>16|e+15<<10|n>>13,!1)}}}function bu(e,t){if(e.length-t<2)throw new Error(`${Nh} not enough data for float16`);const r=(e[t]<<8)+e[t+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,i=1023&r;let o;return o=0===n?i*2**-24:31!==n?(i+1024)*2**(n-25):0===i?1/0:NaN,32768&r?-o:o}function yu(e){lu.setFloat32(0,e,!1)}function wu(e,t){if(e.length-t<4)throw new Error(`${Nh} not enough data for float32`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function gu(e,t){if(e.length-t<8)throw new Error(`${Nh} not enough data for float64`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}function mu(e,t,r){throw new Error(`${Nh} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function vu(e){return()=>{throw new Error(`${Nh} ${e}`)}}uu.compareTokens=jh.compareTokens;const xu=[];for(let e=0;e<=23;e++)xu[e]=mu;xu[24]=function(e,t,r,n){return new vh(mh.uint,Oh(e,t+1,n),2)},xu[25]=function(e,t,r,n){return new vh(mh.uint,Fh(e,t+1,n),3)},xu[26]=function(e,t,r,n){return new vh(mh.uint,Vh(e,t+1,n),5)},xu[27]=function(e,t,r,n){return new vh(mh.uint,Rh(e,t+1,n),9)},xu[28]=mu,xu[29]=mu,xu[30]=mu,xu[31]=mu;for(let e=32;e<=55;e++)xu[e]=mu;xu[56]=function(e,t,r,n){return new vh(mh.negint,-1-Oh(e,t+1,n),2)},xu[57]=function(e,t,r,n){return new vh(mh.negint,-1-Fh(e,t+1,n),3)},xu[58]=function(e,t,r,n){return new vh(mh.negint,-1-Vh(e,t+1,n),5)},xu[59]=function(e,t,r,n){const i=Rh(e,t+1,n);if("bigint"!=typeof i){const e=-1-i;if(e>=Number.MIN_SAFE_INTEGER)return new vh(mh.negint,e,9)}if(!0!==n.allowBigInt)throw new Error(`${Nh} integers outside of the safe integer range are not supported`);return new vh(mh.negint,qh-BigInt(i),9)},xu[60]=mu,xu[61]=mu,xu[62]=mu,xu[63]=mu;for(let e=64;e<=87;e++)xu[e]=Qh;xu[88]=function(e,t,r,n){return Wh(e,t,2,Oh(e,t+1,n))},xu[89]=function(e,t,r,n){return Wh(e,t,3,Fh(e,t+1,n))},xu[90]=function(e,t,r,n){return Wh(e,t,5,Vh(e,t+1,n))},xu[91]=function(e,t,r,n){const i=Rh(e,t+1,n);if("bigint"==typeof i)throw new Error(`${Nh} 64-bit integer bytes lengths not supported`);return Wh(e,t,9,i)},xu[92]=mu,xu[93]=mu,xu[94]=mu,xu[95]=vu("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)xu[e]=Yh;xu[120]=function(e,t,r,n){return Zh(e,t,2,Oh(e,t+1,n),n)},xu[121]=function(e,t,r,n){return Zh(e,t,3,Fh(e,t+1,n),n)},xu[122]=function(e,t,r,n){return Zh(e,t,5,Vh(e,t+1,n),n)},xu[123]=function(e,t,r,n){const i=Rh(e,t+1,n);if("bigint"==typeof i)throw new Error(`${Nh} 64-bit integer string lengths not supported`);return Zh(e,t,9,i,n)},xu[124]=mu,xu[125]=mu,xu[126]=mu,xu[127]=vu("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)xu[e]=ru;xu[152]=function(e,t,r,n){return tu(0,0,2,Oh(e,t+1,n))},xu[153]=function(e,t,r,n){return tu(0,0,3,Fh(e,t+1,n))},xu[154]=function(e,t,r,n){return tu(0,0,5,Vh(e,t+1,n))},xu[155]=function(e,t,r,n){const i=Rh(e,t+1,n);if("bigint"==typeof i)throw new Error(`${Nh} 64-bit integer array lengths not supported`);return tu(0,0,9,i)},xu[156]=mu,xu[157]=mu,xu[158]=mu,xu[159]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${Nh} indefinite length items not allowed`);return tu(0,0,1,1/0)};for(let e=160;e<=183;e++)xu[e]=ou;xu[184]=function(e,t,r,n){return iu(0,0,2,Oh(e,t+1,n))},xu[185]=function(e,t,r,n){return iu(0,0,3,Fh(e,t+1,n))},xu[186]=function(e,t,r,n){return iu(0,0,5,Vh(e,t+1,n))},xu[187]=function(e,t,r,n){const i=Rh(e,t+1,n);if("bigint"==typeof i)throw new Error(`${Nh} 64-bit integer map lengths not supported`);return iu(0,0,9,i)},xu[188]=mu,xu[189]=mu,xu[190]=mu,xu[191]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${Nh} indefinite length items not allowed`);return iu(0,0,1,1/0)};for(let e=192;e<=215;e++)xu[e]=au;xu[216]=function(e,t,r,n){return new vh(mh.tag,Oh(e,t+1,n),2)},xu[217]=function(e,t,r,n){return new vh(mh.tag,Fh(e,t+1,n),3)},xu[218]=function(e,t,r,n){return new vh(mh.tag,Vh(e,t+1,n),5)},xu[219]=function(e,t,r,n){return new vh(mh.tag,Rh(e,t+1,n),9)},xu[220]=mu,xu[221]=mu,xu[222]=mu,xu[223]=mu;for(let e=224;e<=243;e++)xu[e]=vu("simple values are not supported");xu[244]=mu,xu[245]=mu,xu[246]=mu,xu[247]=function(e,t,r,n){if(!1===n.allowUndefined)throw new Error(`${Nh} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new vh(mh.null,null,1):new vh(mh.undefined,void 0,1)},xu[248]=vu("simple values are not supported"),xu[249]=function(e,t,r,n){return hu(bu(e,t+1),3,n)},xu[250]=function(e,t,r,n){return hu(wu(e,t+1),5,n)},xu[251]=function(e,t,r,n){return hu(gu(e,t+1),9,n)},xu[252]=mu,xu[253]=mu,xu[254]=mu,xu[255]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${Nh} indefinite length items not allowed`);return new vh(mh.break,void 0,1)};const Au=[];for(let e=0;e<24;e++)Au[e]=new vh(mh.uint,e,1);for(let e=-1;e>=-24;e--)Au[31-e]=new vh(mh.negint,e,1);Au[64]=new vh(mh.bytes,new Uint8Array(0),1),Au[96]=new vh(mh.string,"",1),Au[128]=new vh(mh.array,0,1),Au[160]=new vh(mh.map,0,1),Au[244]=new vh(mh.false,!1,1),Au[245]=new vh(mh.true,!0,1),Au[246]=new vh(mh.null,null,1),function(){const e=[];e[mh.uint.major]=jh,e[mh.negint.major]=Gh,e[mh.bytes.major]=Xh,e[mh.string.major]=eu,e[mh.array.major]=nu,e[mh.map.major]=su,e[mh.tag.major]=cu,e[mh.float.major]=uu}(),new class{constructor(e=256){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=Ih(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=_h(r,0,this.cursor)}else t=Uh(this.chunks,this.cursor);return e&&this.reset(),t}};class Eu{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${zh} object contains circular references`);return new Eu(t,e)}}const Cu={null:new vh(mh.null,null),undefined:new vh(mh.undefined,void 0),true:new vh(mh.true,!0),false:new vh(mh.false,!1),emptyArray:new vh(mh.array,0),emptyMap:new vh(mh.map,0)},ku={number:(e,t,r,n)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new vh(e>=0?mh.uint:mh.negint,e):new vh(mh.float,e),bigint:(e,t,r,n)=>e>=BigInt(0)?new vh(mh.uint,e):new vh(mh.negint,e),Uint8Array:(e,t,r,n)=>new vh(mh.bytes,e),string:(e,t,r,n)=>new vh(mh.string,e),boolean:(e,t,r,n)=>e?Cu.true:Cu.false,null:(e,t,r,n)=>Cu.null,undefined:(e,t,r,n)=>Cu.undefined,ArrayBuffer:(e,t,r,n)=>new vh(mh.bytes,new Uint8Array(e)),DataView:(e,t,r,n)=>new vh(mh.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,r,n){if(!e.length)return!0===r.addBreakTokens?[Cu.emptyArray,new vh(mh.break)]:Cu.emptyArray;n=Eu.createCheck(n,e);const i=[];let o=0;for(const t of e)i[o++]=Su(t,r,n);return r.addBreakTokens?[new vh(mh.array,e.length),i,new vh(mh.break)]:[new vh(mh.array,e.length),i]},Object(e,t,r,n){const i="Object"!==t,o=i?e.keys():Object.keys(e),s=i?e.size:o.length;if(!s)return!0===r.addBreakTokens?[Cu.emptyMap,new vh(mh.break)]:Cu.emptyMap;n=Eu.createCheck(n,e);const a=[];let c=0;for(const t of o)a[c++]=[Su(t,r,n),Su(i?e.get(t):e[t],r,n)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(a,r),r.addBreakTokens?[new vh(mh.map,s),a,new vh(mh.break)]:[new vh(mh.map,s),a]}};ku.Map=ku.Object,ku.Buffer=ku.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))ku[`${e}Array`]=ku.DataView;function Su(e,t={},r){const n=function(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(wh.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";return function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(gh.includes(t))return t}(e)||"Object"}(e),i=t&&t.typeEncoders&&t.typeEncoders[n]||ku[n];if("function"==typeof i){const o=i(e,n,t,r);if(null!=o)return o}const o=ku[n];if(!o)throw new Error(`${zh} unsupported type: ${n}`);return o(e,n,t,r)}const _u={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Uu{constructor(e,t={}){this._pos=0,this.data=e,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let t=Au[e];if(void 0===t){const r=xu[e];if(!r)throw new Error(`${Nh} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const n=31&e;t=r(this.data,this._pos,n,this.options)}return this._pos+=t.encodedLength,t}}const Iu=Symbol.for("DONE"),Tu=Symbol.for("BREAK");function Du(e,t){if(e.done())return Iu;const r=e.next();if(r.type===mh.break)return Tu;if(r.type.terminal)return r.value;if(r.type===mh.array)return function(e,t,r){const n=[];for(let i=0;i<e.value;i++){const o=Du(t,r);if(o===Tu){if(e.value===1/0)break;throw new Error(`${Nh} got unexpected break to lengthed array`)}if(o===Iu)throw new Error(`${Nh} found array but not enough entries (got ${i}, expected ${e.value})`);n[i]=o}return n}(r,e,t);if(r.type===mh.map)return function(e,t,r){const n=!0===r.useMaps,i=n?void 0:{},o=n?new Map:void 0;for(let s=0;s<e.value;s++){const a=Du(t,r);if(a===Tu){if(e.value===1/0)break;throw new Error(`${Nh} got unexpected break to lengthed map`)}if(a===Iu)throw new Error(`${Nh} found map but not enough entries (got ${s} [no key], expected ${e.value})`);if(!0!==n&&"string"!=typeof a)throw new Error(`${Nh} non-string keys not supported (got ${typeof a})`);if(!0===r.rejectDuplicateMapKeys&&(n&&o.has(a)||!n&&a in i))throw new Error(`${Nh} found repeat map key "${a}"`);const c=Du(t,r);if(c===Iu)throw new Error(`${Nh} found map but not enough entries (got ${s} [no value], expected ${e.value})`);n?o.set(a,c):i[a]=c}return n?o:i}(r,e,t);if(r.type===mh.tag){if(t.tags&&"function"==typeof t.tags[r.value]){const n=Du(e,t);return t.tags[r.value](n)}throw new Error(`${Nh} tag not supported (${r.value})`)}throw new Error("unsupported")}function Bu(e,t){const[r,n]=function(e,t){if(!(e instanceof Uint8Array))throw new Error(`${Nh} data to decode must be a Uint8Array`);const r=(t=Object.assign({},_u,t)).tokenizer||new Uu(e,t),n=Du(r,t);if(n===Iu)throw new Error(`${Nh} did not find any content to decode`);if(n===Tu)throw new Error(`${Nh} got unexpected break`);return[n,e.subarray(r.pos())]}(e,t);if(n.length>0)throw new Error(`${Nh} too many terminals, data makes no sense`);return r}function Pu(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const Nu=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*h+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,l=o-1;(0!==u||f<i)&&-1!==l;l--,f++)u+=a*s[l]>>>0,s[l]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),b=n;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=t[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var b=c.repeat(r);p<s;++p)b+=e.charAt(h[p]);return b},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class zu{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Lu{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return $u(this,e)}}class Mu{decoders;constructor(e){this.decoders=e}or(e){return $u(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function $u(e,t){return new Mu({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class Ou{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new zu(e,t,r),this.decoder=new Lu(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function Fu({name:e,prefix:t,encode:r,decode:n}){return new Ou(e,t,r,n)}function Vu({name:e,prefix:t,alphabet:r}){const{encode:n,decode:i}=Nu(r,e);return Fu({prefix:t,name:e,encode:n,decode:e=>Pu(i(e))})}function Ru({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return Fu({prefix:t,name:e,encode:e=>function(e,t,r){const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,n,r),decode:t=>function(e,t,r,n){const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s}(t,n,r,e)})}const ju=Ru({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hu=(Ru({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ru({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ru({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ru({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ru({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ru({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ru({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ru({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Vu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));Vu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var qu=128,Ju=-128,Gu=Math.pow(2,31),Wu=128,Qu=127,Ku=Math.pow(2,7),Xu=Math.pow(2,14),Zu=Math.pow(2,21),Yu=Math.pow(2,28),ef=Math.pow(2,35),tf=Math.pow(2,42),rf=Math.pow(2,49),nf=Math.pow(2,56),of=Math.pow(2,63);const sf={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Gu;)r[n++]=255&t|qu,t/=128;for(;t&Ju;)r[n++]=255&t|qu,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&Qu)<<o:(n&Qu)*Math.pow(2,o),o+=7}while(n>=Wu);return e.bytes=s-r,i},encodingLength:function(e){return e<Ku?1:e<Xu?2:e<Zu?3:e<Yu?4:e<ef?5:e<tf?6:e<rf?7:e<nf?8:e<of?9:10}};function af(e,t=0){return[sf.decode(e,t),sf.decode.bytes]}function cf(e,t,r=0){return sf.encode(e,t,r),t}function hf(e){return sf.encodingLength(e)}class uf{code;size;digest;bytes;constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}function ff(e,t){const{bytes:r,version:n}=e;return 0===n?function(e,t,r){const{prefix:n}=r;if(n!==Hu.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i}(r,df(e),t??Hu.encoder):function(e,t,r){const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i}(r,df(e),t??ju.encoder)}const lf=new WeakMap;function df(e){const t=lf.get(e);if(null==t){const t=new Map;return lf.set(e,t),t}return t}class pf{code;version;multihash;bytes;"/";constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==bf)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==yf)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return pf.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=function(e,t){const r=t.byteLength,n=hf(e),i=n+hf(r),o=new Uint8Array(i+r);return cf(e,o,0),cf(r,o,n),o.set(t,i),new uf(e,r,t,o)}(e,t);return pf.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return pf.equals(this,e)}static equals(e,t){const r=t;return null!=r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}}(e.multihash,r.multihash)}toString(e){return ff(this,e)}toJSON(){return{"/":ff(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof pf)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new pf(e,r,n,i??wf(e,r,n.bytes))}if(!0===t[gf]){const{version:e,multihash:r,code:n}=t,i=function(e){const t=Pu(e),[r,n]=af(t),[i,o]=af(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new uf(r,i,s,t)}(r);return pf.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==bf)throw new Error(`Version 0 CID must use dag-pb (code: ${bf}) block encoding`);return new pf(e,t,r,r.bytes);case 1:{const n=wf(e,t,r.bytes);return new pf(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return pf.create(0,bf,e)}static createV1(e,t){return pf.create(1,e,t)}static decode(e){const[t,r]=pf.decodeFirst(e);if(0!==r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=pf.inspectBytes(e),r=t.size-t.multihashSize,n=Pu(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new uf(t.multihashCode,t.digestSize,i,n);return[0===t.version?pf.createV0(o):pf.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=af(e.subarray(t));return t+=n,r};let n=r(),i=bf;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=t,s=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[r,n]=function(e,t){switch(e[0]){case"Q":{const r=t??Hu;return[Hu.prefix,r.decode(`${Hu.prefix}${e}`)]}case Hu.prefix:{const r=t??Hu;return[Hu.prefix,r.decode(e)]}case ju.prefix:{const r=t??ju;return[ju.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}(e,t),i=pf.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return df(i).set(r,e),i}}const bf=112,yf=18;function wf(e,t,r){const n=hf(e),i=n+hf(t),o=new Uint8Array(i+r.byteLength);return cf(e,o,0),cf(t,o,n),o.set(r,i),o}const gf=Symbol.for("@ipld/js-cid/CID"),mf={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};mf.tags[42]=function(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return pf.decode(e.subarray(1))},mf.tags.slice();mh.uint.major,mh.negint.major,mh.bytes.major,mh.string.major,mh.array.major,mh.map.major,mh.tag.major,mh.float.major;class vf{constructor(e,t={}){this._pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;32===e||9===e||13===e||10===e;)e=this.data[++this._pos]}expect(e){if(this.data.length-this._pos<e.length)throw new Error(`${Nh} unexpected end of input at position ${this._pos}`);for(let t=0;t<e.length;t++)if(this.data[this._pos++]!==e[t])throw new Error(`${Nh} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this._pos;let t=!1,r=!1;const n=e=>{for(;!this.done();){const t=this.ch();if(!e.includes(t))break;this._pos++}};if(45===this.ch()&&(t=!0,this._pos++),48===this.ch()){if(this._pos++,46!==this.ch())return new vh(mh.uint,0,this._pos-e);this._pos++,r=!0}if(n([48,49,50,51,52,53,54,55,56,57]),t&&this._pos===e+1)throw new Error(`${Nh} unexpected token at position ${this._pos}`);if(!this.done()&&46===this.ch()){if(r)throw new Error(`${Nh} unexpected token at position ${this._pos}`);r=!0,this._pos++,n([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(r=!0,this._pos++,this.done()||43!==this.ch()&&45!==this.ch()||this._pos++,n([48,49,50,51,52,53,54,55,56,57]));const i=String.fromCharCode.apply(null,this.data.subarray(e,this._pos)),o=parseFloat(i);return r?new vh(mh.float,o,this._pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(o)?new vh(o>=0?mh.uint:mh.negint,o,this._pos-e):new vh(o>=0?mh.uint:mh.negint,BigInt(i),this._pos-e)}parseString(){if(34!==this.ch())throw new Error(`${Nh} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let e=this._pos,t=0;e<this.data.length&&t<65536;e++,t++){const r=this.data[e];if(92===r||r<32||r>=128)break;if(34===r){const r=String.fromCharCode.apply(null,this.data.subarray(this._pos,e));return this._pos=e+1,new vh(mh.string,r,t)}}const e=this._pos,t=[],r=()=>{if(this._pos+4>=this.data.length)throw new Error(`${Nh} unexpected end of unicode escape sequence at position ${this._pos}`);let e=0;for(let t=0;t<4;t++){let t=this.ch();if(t>=48&&t<=57)t-=48;else if(t>=97&&t<=102)t=t-97+10;else{if(!(t>=65&&t<=70))throw new Error(`${Nh} unexpected unicode escape character at position ${this._pos}`);t=t-65+10}e=16*e+t,this._pos++}return e},n=()=>{const e=this.ch();let r,n,i,o,s=null,a=e>239?4:e>223?3:e>191?2:1;if(this._pos+a>this.data.length)throw new Error(`${Nh} unexpected unicode sequence at position ${this._pos}`);switch(a){case 1:e<128&&(s=e);break;case 2:r=this.data[this._pos+1],128==(192&r)&&(o=(31&e)<<6|63&r,o>127&&(s=o));break;case 3:r=this.data[this._pos+1],n=this.data[this._pos+2],128==(192&r)&&128==(192&n)&&(o=(15&e)<<12|(63&r)<<6|63&n,o>2047&&(o<55296||o>57343)&&(s=o));break;case 4:r=this.data[this._pos+1],n=this.data[this._pos+2],i=this.data[this._pos+3],128==(192&r)&&128==(192&n)&&128==(192&i)&&(o=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&i,o>65535&&o<1114112&&(s=o))}null===s?(s=65533,a=1):s>65535&&(s-=65536,t.push(s>>>10&1023|55296),s=56320|1023&s),t.push(s),this._pos+=a};for(;!this.done();){const i=this.ch();let o;switch(i){case 92:if(this._pos++,this.done())throw new Error(`${Nh} unexpected string termination at position ${this._pos}`);switch(o=this.ch(),this._pos++,o){case 34:case 39:case 92:case 47:t.push(o);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(r());break;default:throw new Error(`${Nh} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new vh(mh.string,Ph(t),this._pos-e);default:if(i<32)throw new Error(`${Nh} invalid control character at position ${this._pos}`);i<128?(t.push(i),this._pos++):n()}}throw new Error(`${Nh} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new vh(mh.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new vh(mh.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new vh(mh.null,null,4);case 102:return this.expect([102,97,108,115,101]),new vh(mh.false,!1,5);case 116:return this.expect([116,114,117,101]),new vh(mh.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${Nh} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this._pos++,this.skipWhitespace(),new vh(mh.break,void 0,1);if(44!==this.ch())throw new Error(`${Nh} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this._pos++,this.skipWhitespace(),new vh(mh.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new vh(mh.break,void 0,1);if(44!==this.ch())throw new Error(`${Nh} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this._pos++,this.skipWhitespace(),new vh(mh.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error(`${Nh} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${Nh} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}}function xf(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const Af=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*h+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,l=o-1;(0!==u||f<i)&&-1!==l;l--,f++)u+=a*s[l]>>>0,s[l]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),b=n;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=t[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var b=c.repeat(r);p<s;++p)b+=e.charAt(h[p]);return b},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class Ef{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Cf{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Sf(this,e)}}class kf{decoders;constructor(e){this.decoders=e}or(e){return Sf(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function Sf(e,t){return new kf({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class _f{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Ef(e,t,r),this.decoder=new Cf(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function Uf({name:e,prefix:t,encode:r,decode:n}){return new _f(e,t,r,n)}function If({name:e,prefix:t,alphabet:r}){const{encode:n,decode:i}=Af(r,e);return Uf({prefix:t,name:e,encode:n,decode:e=>xf(i(e))})}function Tf({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return Uf({prefix:t,name:e,encode:e=>function(e,t,r){const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,n,r),decode:t=>function(e,t,r,n){const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s}(t,n,r,e)})}const Df=Tf({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Bf=(Tf({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Tf({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Tf({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Tf({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Tf({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Tf({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Tf({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Tf({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),If({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));If({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Pf=128,Nf=-128,zf=Math.pow(2,31),Lf=128,Mf=127,$f=Math.pow(2,7),Of=Math.pow(2,14),Ff=Math.pow(2,21),Vf=Math.pow(2,28),Rf=Math.pow(2,35),jf=Math.pow(2,42),Hf=Math.pow(2,49),qf=Math.pow(2,56),Jf=Math.pow(2,63);const Gf={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=zf;)r[n++]=255&t|Pf,t/=128;for(;t&Nf;)r[n++]=255&t|Pf,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&Mf)<<o:(n&Mf)*Math.pow(2,o),o+=7}while(n>=Lf);return e.bytes=s-r,i},encodingLength:function(e){return e<$f?1:e<Of?2:e<Ff?3:e<Vf?4:e<Rf?5:e<jf?6:e<Hf?7:e<qf?8:e<Jf?9:10}};function Wf(e,t=0){return[Gf.decode(e,t),Gf.decode.bytes]}function Qf(e,t,r=0){return Gf.encode(e,t,r),t}function Kf(e){return Gf.encodingLength(e)}class Xf{code;size;digest;bytes;constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}function Zf(e,t){const{bytes:r,version:n}=e;return 0===n?function(e,t,r){const{prefix:n}=r;if(n!==Bf.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i}(r,el(e),t??Bf.encoder):function(e,t,r){const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i}(r,el(e),t??Df.encoder)}const Yf=new WeakMap;function el(e){const t=Yf.get(e);if(null==t){const t=new Map;return Yf.set(e,t),t}return t}class tl{code;version;multihash;bytes;"/";constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==rl)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==nl)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return tl.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=function(e,t){const r=t.byteLength,n=Kf(e),i=n+Kf(r),o=new Uint8Array(i+r);return Qf(e,o,0),Qf(r,o,n),o.set(t,i),new Xf(e,r,t,o)}(e,t);return tl.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return tl.equals(this,e)}static equals(e,t){const r=t;return null!=r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}}(e.multihash,r.multihash)}toString(e){return Zf(this,e)}toJSON(){return{"/":Zf(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof tl)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new tl(e,r,n,i??il(e,r,n.bytes))}if(!0===t[ol]){const{version:e,multihash:r,code:n}=t,i=function(e){const t=xf(e),[r,n]=Wf(t),[i,o]=Wf(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Xf(r,i,s,t)}(r);return tl.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==rl)throw new Error(`Version 0 CID must use dag-pb (code: ${rl}) block encoding`);return new tl(e,t,r,r.bytes);case 1:{const n=il(e,t,r.bytes);return new tl(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return tl.create(0,rl,e)}static createV1(e,t){return tl.create(1,e,t)}static decode(e){const[t,r]=tl.decodeFirst(e);if(0!==r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=tl.inspectBytes(e),r=t.size-t.multihashSize,n=xf(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new Xf(t.multihashCode,t.digestSize,i,n);return[0===t.version?tl.createV0(o):tl.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=Wf(e.subarray(t));return t+=n,r};let n=r(),i=rl;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=t,s=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[r,n]=function(e,t){switch(e[0]){case"Q":{const r=t??Bf;return[Bf.prefix,r.decode(`${Bf.prefix}${e}`)]}case Bf.prefix:{const r=t??Bf;return[Bf.prefix,r.decode(e)]}case Df.prefix:{const r=t??Df;return[Df.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}(e,t),i=tl.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return el(i).set(r,e),i}}const rl=112,nl=18;function il(e,t,r){const n=Kf(e),i=n+Kf(t),o=new Uint8Array(i+r.byteLength);return Qf(e,o,0),Qf(t,o,n),o.set(r,i),o}const ol=Symbol.for("@ipld/js-cid/CID"),sl=Tf({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Tf({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Tf({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Tf({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});class al extends vf{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===mh.map){const e=this._next();if(e.type===mh.string&&"/"===e.value){const e=this._next();if(e.type===mh.string){if(this._next().type!==mh.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new vh(mh.tag,42,0)}if(e.type===mh.map){const e=this._next();if(e.type===mh.string&&"bytes"===e.value){const e=this._next();if(e.type===mh.string){for(let e=0;e<2;e++)if(this._next().type!==mh.break)throw new Error("Invalid encoded Bytes form");const t=sl.decode(`m${e.value}`);return new vh(mh.bytes,t,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const cl={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};cl.tags[42]=tl.parse;const hl=(new TextDecoder,new TextEncoder,new TextEncoder,new TextDecoder);function ul(e,t,r,n,i,o,s){let a=e,c=i;for(;o.length>0;){const h=o[0];if(!(h in a))throw oe(new Error(`No property named ${h} found in node ${r}`),"ERR_NO_PROP");{o.shift(),c=`${c}/${h}`;const u=lh.asCID(a[h]);if(null!=u)return{entry:{type:"object",name:n,path:i,cid:r,node:t,depth:s,size:BigInt(t.length),content:async function*(){yield e}},next:{cid:u,name:h,path:c,toResolve:o}};a=a[h]}}return{entry:{type:"object",name:n,path:i,cid:r,node:t,depth:s,size:BigInt(t.length),content:async function*(){yield e}}}}const fl=function(e,t,r,n){const i=BigInt(e.length),o=BigInt(t+i);return r>=o||n<t?new Uint8Array(0):(n>=t&&n<o&&(e=e.subarray(0,Number(n-t))),r>=t&&r<o&&(e=e.subarray(Number(r-t))),e)},ll=(e,t=0,r=e)=>{const n=BigInt(e),i=BigInt(t??0);let o=BigInt(r);if(o!==n&&(o=i+o),o>n&&(o=n),i<0n)throw oe(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(i>n)throw oe(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(o<0n)throw oe(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(o>n)throw oe(new Error("Length must be less than the file size"),"ERR_INVALID_PARAMS");return{start:i,end:o}},dl=async function(e){return(await Bs.encode(e)).slice(0,8).reverse()},pl=(e,t)=>e.toString(16).toUpperCase().padStart(t,"0").substring(0,t),bl=async(e,t,r,n,i)=>{if(null==n){if(null==e.Data)throw oe(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let t;try{t=ti.unmarshal(e.Data)}catch(e){throw oe(e,"ERR_NOT_UNIXFS")}if("hamt-sharded-directory"!==t.type)throw oe(new Error("not a HAMT"),"ERR_NOT_UNIXFS");if(null==t.fanout)throw oe(new Error("missing fanout"),"ERR_NOT_UNIXFS");const r=wc({hashFn:dl,bits:Math.log2(Number(t.fanout))});n={rootBucket:r,hamtDepth:1,lastBucket:r}}const o=(n.lastBucket.tableSize()-1).toString(16).length;await(async(e,t,r)=>{const n=(t.tableSize()-1).toString(16).length;await Promise.all(e.map((async e=>{if(null==e.Name)throw new Error("Unexpected Link without a Name");if(e.Name.length!==n)await r.put(e.Name.substring(2),!0);else{const n=parseInt(e.Name,16);t._putObjectAt(n,new sc({hash:r._options.hash,bits:r._options.bits},t,n))}})))})(e.Links,n.lastBucket,n.rootBucket);const s=await n.rootBucket._findNewBucketAndPos(t);let a=pl(s.pos,o);const c=(e=>{let t=e.bucket;const r=[];for(;null!=t._parent;)r.push(t),t=t._parent;return r.push(t),r.reverse()})(s);c.length>n.hamtDepth&&(n.lastBucket=c[n.hamtDepth],a=pl(n.lastBucket._posAtParent,o));const h=e.Links.find((e=>{if(null==e.Name)return!1;const r=e.Name.substring(0,o),n=e.Name.substring(o);return r===a&&(""===n||n===t)}));if(null!=h)return null!=h.Name&&h.Name.substring(o)===t?h.Hash:(n.hamtDepth++,e=Tt(await r.get(h.Hash,i)),bl(e,t,r,n,i))},yl=bl,wl=function(e){const[t,r]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>t.next(),push:e=>{n.push(e)},next:()=>n.length>0?{done:!1,value:n.shift()}:t.next(),[r](){return this}}},gl=function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e)yield t(r)}();const r=wl(e),{value:n,done:i}=r.next();if(!0===i)return function*(){}();const o=t(n);if("function"==typeof o.then)return async function*(){yield await o;for await(const e of r)yield t(e)}();const s=t;return function*(){yield o;for(const e of r)yield s(e)}()};function ml(){const e={};return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e}const vl=globalThis.CustomEvent??Event;async function*xl(e,t={}){let r=t.concurrency??1/0;r<1&&(r=1/0);const n=null!=t.ordered&&t.ordered,i=new EventTarget,o=[];let s,a=ml(),c=ml(),h=!1,u=!1;function f(){return n?o[0]?.done:Boolean(o.find((e=>e.done)))}function*l(){for(;o.length>0&&o[0].done;){const e=o[0];if(o.shift(),!e.ok)throw u=!0,a.resolve(),e.err;yield e.value,a.resolve()}}function*d(){for(;f();)for(let e=0;e<o.length;e++)if(o[e].done){const t=o[e];if(o.splice(e,1),e--,!t.ok)throw u=!0,a.resolve(),t.err;yield t.value,a.resolve()}}for(i.addEventListener("task-complete",(()=>{c.resolve()})),Promise.resolve().then((async()=>{try{for await(const t of e){if(o.length===r&&(a=ml(),await a.promise),u)break;const e={done:!1};o.push(e),t().then((t=>{e.done=!0,e.ok=!0,e.value=t,i.dispatchEvent(new vl("task-complete"))}),(t=>{e.done=!0,e.err=t,i.dispatchEvent(new vl("task-complete"))}))}h=!0,i.dispatchEvent(new vl("task-complete"))}catch(e){s=e,i.dispatchEvent(new vl("task-complete"))}}));;){if(f()||(c=ml(),await c.promise),null!=s)throw s;if(n?yield*l():yield*d(),h&&0===o.length)break}}class Al{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class El{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Al(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new Al(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}class Cl extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function kl(e={}){return function(e,t){let r,n,i,o=(t=t??{}).onEnd,s=new El,a=ml();const c=e=>null!=n?n(e):(s.push(e),r),h=e=>{if(i)return r;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},u=e=>i?r:(i=!0,null!=e?(e=>(s=new El,null!=n?n({error:e}):(s.push({error:e}),r)))(e):c({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return s.isEmpty()?i?{done:!0}:await new Promise(((t,i)=>{n=o=>{n=null,s.push(o);try{t(e(s))}catch(e){i(e)}return r}})):e(s)}finally{s.isEmpty()&&queueMicrotask((()=>{a.resolve(),a=ml()}))}},return:()=>(s=new El,u(),{done:!0}),throw:e=>(u(e),{done:!0}),push:h,end:u,get readableLength(){return s.size},onEmpty:async e=>{const t=e?.signal;if(t?.throwIfAborted(),s.isEmpty())return;let r,n;null!=t&&(r=new Promise(((e,r)=>{n=()=>{r(new Cl)},t.addEventListener("abort",n)})));try{await Promise.race([a.promise,r])}finally{null!=n&&null!=t&&t?.removeEventListener("abort",n)}}},null==o)return r;const f=r;return r={[Symbol.asyncIterator](){return this},next:()=>f.next(),throw:e=>(f.throw(e),null!=o&&(o(e),o=void 0),{done:!0}),return:()=>(f.return(),null!=o&&(o(),o=void 0),{done:!0}),push:h,end:e=>(f.end(e),null!=o&&(o(e),o=void 0),r),get readableLength(){return f.readableLength},onEmpty:e=>f.onEmpty(e)},r}((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}function Sl(e,...t){if(null==e)throw new Error("Empty pipeline");if(Tl(e)){const t=e;e=()=>t.source}else if(Il(e)||Ul(e)){const t=e;e=()=>t}const r=[e,...t];if(r.length>1&&Tl(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let e=1;e<r.length-1;e++)Tl(r[e])&&(r[e]=Dl(r[e]));return _l(...r)}const _l=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},Ul=e=>null!=e?.[Symbol.asyncIterator],Il=e=>null!=e?.[Symbol.iterator],Tl=e=>null!=e&&null!=e.sink&&null!=e.source,Dl=e=>t=>{const r=e.sink(t);if(null!=r?.then){const t=kl({objectMode:!0});let n;r.then((()=>{t.end()}),(e=>{t.end(e)}));const i=e.source;if(Ul(i))n=async function*(){yield*i,t.end()};else{if(!Il(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");n=function*(){yield*i,t.end()}}return function(...e){const t=[];for(const r of e)null==r[Symbol.asyncIterator]&&t.push(r);return t.length===e.length?function*(){for(const e of t)yield*e}():async function*(){const t=kl({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(e.map((async e=>{for await(const r of e)t.push(r)}))),t.end()}catch(e){t.end(e)}})),yield*t}()}(t,n())}return e.source};var Bl=r(228);class Pl extends Error{constructor(e){super(e),this.name="TimeoutError"}}class Nl extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const zl=e=>void 0===globalThis.DOMException?new Nl(e):new DOMException(e),Ll=e=>{const t=void 0===e.reason?zl("This operation was aborted."):e.reason;return t instanceof Error?t:zl(t)};class Ml{#e=[];enqueue(e,t){const r={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&this.#e[this.size-1].priority>=t.priority)return void this.#e.push(r);const n=function(e,t,r){let n=0,i=e.length;for(;i>0;){const r=Math.trunc(i/2);let s=n+r;o=e[s],t.priority-o.priority<=0?(n=++s,i-=r+1):i=r}var o;return n}(this.#e,r);this.#e.splice(n,0,r)}dequeue(){const e=this.#e.shift();return e?.run}filter(e){return this.#e.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this.#e.length}}class $l extends Bl{#t;#r;#n=0;#i;#o;#s=0;#a;#c;#e;#h;#u=0;#f;#l;#d;timeout;constructor(e){if(super(),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Ml,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.interval})`);this.#t=e.carryoverConcurrencyCount,this.#r=e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,this.#i=e.intervalCap,this.#o=e.interval,this.#e=new e.queueClass,this.#h=e.queueClass,this.concurrency=e.concurrency,this.timeout=e.timeout,this.#d=!0===e.throwOnTimeout,this.#l=!1===e.autoStart}get#p(){return this.#r||this.#n<this.#i}get#b(){return this.#u<this.#f}#y(){this.#u--,this.#w(),this.emit("next")}#g(){this.#m(),this.#v(),this.#c=void 0}get#x(){const e=Date.now();if(void 0===this.#a){const t=this.#s-e;if(!(t<0))return void 0===this.#c&&(this.#c=setTimeout((()=>{this.#g()}),t)),!0;this.#n=this.#t?this.#u:0}return!1}#w(){if(0===this.#e.size)return this.#a&&clearInterval(this.#a),this.#a=void 0,this.emit("empty"),0===this.#u&&this.emit("idle"),!1;if(!this.#l){const e=!this.#x;if(this.#p&&this.#b){const t=this.#e.dequeue();return!!t&&(this.emit("active"),t(),e&&this.#v(),!0)}}return!1}#v(){this.#r||void 0!==this.#a||(this.#a=setInterval((()=>{this.#m()}),this.#o),this.#s=Date.now()+this.#o)}#m(){0===this.#n&&0===this.#u&&this.#a&&(clearInterval(this.#a),this.#a=void 0),this.#n=this.#t?this.#u:0,this.#A()}#A(){for(;this.#w(););}get concurrency(){return this.#f}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#f=e,this.#A()}async#E(e){return new Promise(((t,r)=>{e.addEventListener("abort",(()=>{r(e.reason)}),{once:!0})}))}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:this.#d,...t},new Promise(((r,n)=>{this.#e.enqueue((async()=>{this.#u++,this.#n++;try{t.signal?.throwIfAborted();let n=e({signal:t.signal});t.timeout&&(n=function(e,t){const{milliseconds:r,fallback:n,message:i,customTimers:o={setTimeout,clearTimeout}}=t;let s;const a=new Promise(((a,c)=>{if("number"!=typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(t.signal){const{signal:e}=t;e.aborted&&c(Ll(e)),e.addEventListener("abort",(()=>{c(Ll(e))}))}if(r===Number.POSITIVE_INFINITY)return void e.then(a,c);const h=new Pl;s=o.setTimeout.call(void 0,(()=>{if(n)try{a(n())}catch(e){c(e)}else"function"==typeof e.cancel&&e.cancel(),!1===i?a():i instanceof Error?c(i):(h.message=i??`Promise timed out after ${r} milliseconds`,c(h))}),r),(async()=>{try{a(await e)}catch(e){c(e)}})()})),c=a.finally((()=>{c.clear()}));return c.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},c}(Promise.resolve(n),{milliseconds:t.timeout})),t.signal&&(n=Promise.race([n,this.#E(t.signal)]));const i=await n;r(i),this.emit("completed",i)}catch(e){if(e instanceof Pl&&!t.throwOnTimeout)return void r();n(e),this.emit("error",e)}finally{this.#y()}}),t),this.emit("add"),this.#w()}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this.#l?(this.#l=!1,this.#A(),this):this}pause(){this.#l=!0}clear(){this.#e=new this.#h}async onEmpty(){0!==this.#e.size&&await this.#C("empty")}async onSizeLessThan(e){this.#e.size<e||await this.#C("next",(()=>this.#e.size<e))}async onIdle(){0===this.#u&&0===this.#e.size||await this.#C("idle")}async#C(e,t){return new Promise((r=>{const n=()=>{t&&!t()||(this.off(e,n),r())};this.on(e,n)}))}get size(){return this.#e.size}sizeBy(e){return this.#e.filter(e).length}get pending(){return this.#u}get isPaused(){return this.#l}}async function Ol(e,t,r,n,i,o,s){if(t instanceof Uint8Array){const e=fl(t,n,i,o);return void r.push(e)}if(null==t.Data)throw oe(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let a;try{a=ti.unmarshal(t.Data)}catch(e){throw oe(e,"ERR_NOT_UNIXFS")}if(null!=a.data){const e=a.data,t=fl(e,n,i,o);r.push(t),n+=BigInt(t.byteLength)}const c=[];if(t.Links.length!==a.blockSizes.length)throw oe(new Error("Inconsistent block sizes and dag links"),"ERR_NOT_UNIXFS");for(let e=0;e<t.Links.length;e++){const r=t.Links[e],s=n,h=s+a.blockSizes[e];if((i>=s&&i<h||o>=s&&o<=h||i<s&&o>h)&&c.push({link:r,blockStart:n}),(n=h)>o)break}await Sl(c,(t=>gl(t,(t=>async()=>{const r=await e.get(t.link.Hash,s);return{...t,block:r}}))),(e=>xl(e,{ordered:!0,concurrency:s.blockReadConcurrency})),(async t=>{for await(const{link:n,block:a,blockStart:c}of t){let t;switch(n.Hash.code){case Ut:t=Tt(a);break;case 85:t=a;break;default:return void r.end(oe(new Error(`Unsupported codec: ${n.Hash.code}`),"ERR_NOT_UNIXFS"))}const h=new $l({concurrency:1});h.on("error",(e=>{r.end(e)})),h.add((async()=>{s.onProgress?.(new ai("unixfs:exporter:walk:file",{cid:n.Hash})),await Ol(e,t,r,c,i,o,s)})),await h.onIdle()}})),n>=o&&r.end()}const Fl=(e,t,r,n,i,o,s)=>async function*(n={}){const i=r.fileSize();if(void 0===i)throw new Error("File was a directory");const{start:o,end:a}=ll(i,n.offset,n.length);if(0n===a)return;let c=0n;const h=a-o,u=kl();n.onProgress?.(new ai("unixfs:exporter:walk:file",{cid:e})),Ol(s,t,u,0n,o,a,n).catch((e=>{u.end(e)}));for await(const e of u)if(null!=e){if(c+=BigInt(e.byteLength),c>h)throw u.end(),oe(new Error("Read too many bytes - the file size reported by the UnixFS data in the root node may be incorrect"),"ERR_OVER_READ");c===h&&u.end(),n.onProgress?.(new ai("unixfs:exporter:progress:unixfs:file",{bytesRead:c,totalBytes:h,fileSize:i})),yield e}if(c<h)throw oe(new Error("Traversed entire DAG but did not read enough bytes"),"ERR_UNDER_READ")};async function*Vl(e,t,r,n,i,o){const s=e.Links;if(null==e.Data)throw oe(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let a;try{a=ti.unmarshal(e.Data)}catch(e){throw oe(e,"ERR_NOT_UNIXFS")}if(null==a.fanout)throw oe(new Error("missing fanout"),"ERR_NOT_UNIXFS");const c=(a.fanout-1n).toString(16).length,h=Sl(s,(s=>gl(s,(s=>async()=>{const a=null!=s.Name?s.Name.substring(c):null;if(null!=a&&""!==a){const e=await r(s.Hash,a,`${t}/${a}`,[],n+1,i,o);return{entries:null==e.entry?[]:[e.entry]}}{const a=await i.get(s.Hash,o);return e=Tt(a),o.onProgress?.(new ai("unixfs:exporter:walk:hamt-sharded-directory",{cid:s.Hash})),{entries:Vl(e,t,r,n,i,o)}}}))),(e=>xl(e,{ordered:!0,concurrency:o.blockReadConcurrency})));for await(const{entries:e}of h)yield*e}const Rl={raw:Fl,file:Fl,directory:(e,t,r,n,i,o,s)=>async function*(r={}){const a=r.offset??0,c=r.length??t.Links.length,h=t.Links.slice(a,c);r.onProgress?.(new ai("unixfs:exporter:walk:directory",{cid:e})),yield*Sl(h,(e=>gl(e,(e=>async()=>{const t=e.Name??"",a=`${n}/${t}`;return(await i(e.Hash,t,a,[],o+1,s,r)).entry}))),(e=>xl(e,{ordered:!0,concurrency:r.blockReadConcurrency})),(e=>function(e,t){if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e)await t(r)&&(yield r)}();const r=wl(e),{value:n,done:i}=r.next();if(!0===i)return function*(){}();const o=t(n);if("function"==typeof o.then)return async function*(){await o&&(yield n);for await(const e of r)await t(e)&&(yield e)}();const s=t;return function*(){!0===o&&(yield n);for(const e of r)s(e)&&(yield e)}()}(e,(e=>null!=e))))},"hamt-sharded-directory":(e,t,r,n,i,o,s)=>function(r={}){return r.onProgress?.(new ai("unixfs:exporter:walk:hamt-sharded-directory",{cid:e})),Vl(t,n,i,o,s,r)},metadata:(e,t,r,n,i,o,s)=>()=>[],symlink:(e,t,r,n,i,o,s)=>()=>[]},jl={[Ut]:async(e,t,r,n,i,o,s,a)=>{const c=Tt(await s.get(e,a));let h,u;if(null==t&&(t=e.toString()),null==c.Data)throw oe(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{h=ti.unmarshal(c.Data)}catch(e){throw oe(e,"ERR_NOT_UNIXFS")}if(null==r&&(r=t),n.length>0){let e;if(e="hamt-sharded-directory"===h?.type?await yl(c,n[0],s):((e,t)=>{const r=e.Links.find((e=>e.Name===t));return r?.Hash})(c,n[0]),null==e)throw oe(new Error("file does not exist"),"ERR_NOT_FOUND");const t=n.shift();u={cid:e,toResolve:n,name:t??"",path:`${r}/${t}`}}const f=Rl[h.type](e,c,h,r,i,o,s);if(null==f)throw oe(new Error("could not find content exporter"),"ERR_NOT_FOUND");return h.isDirectory()?{entry:{type:"directory",name:t,path:r,cid:e,content:f,unixfs:h,depth:o,node:c,size:h.fileSize()},next:u}:{entry:{type:"file",name:t,path:r,cid:e,content:f,unixfs:h,depth:o,node:c,size:h.fileSize()},next:u}},85:async(e,t,r,n,i,o,s,a)=>{if(n.length>0)throw oe(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const c=await s.get(e,a);return{entry:{type:"raw",name:t,path:r,cid:e,content:(h=c,async function*(e={}){const{start:t,end:r}=ll(h.length,e.offset,e.length),n=fl(h,0n,t,r);e.onProgress?.(new ai("unixfs:exporter:progress:raw",{bytesRead:BigInt(n.byteLength),totalBytes:r-t,fileSize:BigInt(h.byteLength)})),yield n}),depth:o,size:BigInt(c.length),node:c}};var h},113:async(e,t,r,n,i,o,s,a)=>{const c=await s.get(e,a);return ul(Bu((h=c)instanceof ArrayBuffer?new Uint8Array(h,0,h.byteLength):h,mf),c,e,t,r,n,o);var h},297:async(e,t,r,n,i,o,s,a)=>{const c=await s.get(e,a);return ul((e=>{const t=function(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}(e);return function(e,t){return Bu(e,t=Object.assign({tokenizer:new vf(e,t)},t))}(t,Object.assign(cl,{tokenizer:new al(t,cl)}))})(c),c,e,t,r,n,o)},0:async(e,t,r,n,i,o,s,a)=>{if(n.length>0)throw oe(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const c=ah(e.multihash.bytes);return{entry:{type:"identity",name:t,path:r,cid:e,content:(h=c.digest,async function*(e={}){const{start:t,end:r}=ll(h.length,e.offset,e.length),n=fl(h,0n,t,r);e.onProgress?.(new ai("unixfs:exporter:progress:identity",{bytesRead:BigInt(n.byteLength),totalBytes:r-t,fileSize:BigInt(h.byteLength)})),yield n}),depth:o,size:BigInt(c.digest.length),node:c.digest}};var h},512:async(e,t,r,n,i,o,s,a)=>{const c=await s.get(e,a);var h;return ul((h=c,JSON.parse(hl.decode(h))),c,e,t,r,n,o)}},Hl=async(e,t,r,n,i,o,s)=>{const a=jl[e.code];if(null==a)throw oe(new Error(`No resolver for code ${e.code}`),"ERR_NO_RESOLVER");return a(e,t,r,n,Hl,i,o,s)},ql=Hl,Jl=e=>{if(e instanceof Uint8Array)return{cid:lh.decode(e),toResolve:[]};const t=lh.asCID(e);if(null!=t)return{cid:t,toResolve:[]};if("string"==typeof e){0===e.indexOf("/ipfs/")&&(e=e.substring(6));const t=((e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)??[]).filter(Boolean))(e);return{cid:lh.parse(t[0]),toResolve:t.slice(1)}}throw oe(new Error(`Unknown path type ${e}`),"ERR_BAD_PATH")};async function*Gl(e,t,r={}){let{cid:n,toResolve:i}=Jl(e),o=n.toString(),s=o;const a=i.length;for(;;){const c=await ql(n,o,s,i,a,t,r);if(null==c.entry&&null==c.next)throw oe(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");if(null!=c.entry&&(yield c.entry),null==c.next)return;i=c.next.toResolve,n=c.next.cid,o=c.next.name,s=c.next.path}}async function Wl(e,t,r={}){const n=await Tc(Gl(e,t,r));if(null==n)throw oe(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");return n}async function*Ql(e,t,r={}){const n=await Wl(e,t,r);if(null!=n&&(yield n,"directory"===n.type))for await(const e of async function*e(t,r){for await(const n of t.content(r))yield n,n instanceof Uint8Array||"directory"===n.type&&(yield*e(n,r))}(n,r))yield e}const Kl=r(864);class Xl extends Error{name;code;constructor(e,t,r){super(e),this.name=t,this.code=r}}class Zl extends Xl{constructor(e="not a Unixfs node"){super(e,"NotUnixFSError","ERR_NOT_UNIXFS")}}class Yl extends Xl{constructor(e="invalid PBNode"){super(e,"InvalidPBNodeError","ERR_INVALID_PBNODE")}}class ed extends Xl{constructor(e="unknown error"){super(e,"InvalidPBNodeError","ERR_UNKNOWN_ERROR")}}class td extends Xl{constructor(e="path already exists"){super(e,"AlreadyExistsError","ERR_ALREADY_EXISTS")}}class rd extends Xl{constructor(e="path does not exist"){super(e,"DoesNotExistError","ERR_DOES_NOT_EXIST")}}class nd extends Xl{constructor(e="no content"){super(e,"NoContentError","ERR_NO_CONTENT")}}class id extends Xl{constructor(e="not a file"){super(e,"NotAFileError","ERR_NOT_A_FILE")}}class od extends Xl{constructor(e="not a directory"){super(e,"NotADirectoryError","ERR_NOT_A_DIRECTORY")}}class sd extends Xl{constructor(e="invalid parameters"){super(e,"InvalidParametersError","ERR_INVALID_PARAMETERS")}}var ad=r(833);new Uint8Array(0);const cd=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*h+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,l=o-1;(0!==u||f<i)&&-1!==l;l--,f++)u+=a*s[l]>>>0,s[l]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),b=n;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=t[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var b=c.repeat(r);p<s;++p)b+=e.charAt(h[p]);return b},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class hd{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ud{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return ld(this,e)}}class fd{decoders;constructor(e){this.decoders=e}or(e){return ld(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function ld(e,t){return new fd({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class dd{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new hd(e,t,r),this.decoder=new ud(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function pd({name:e,prefix:t,encode:r,decode:n}){return new dd(e,t,r,n)}function bd({name:e,prefix:t,alphabet:r}){const{encode:n,decode:i}=cd(r,e);return pd({prefix:t,name:e,encode:n,decode:e=>function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}(i(e))})}function yd({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return pd({prefix:t,name:e,encode:e=>function(e,t,r){const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,n,r),decode:t=>function(e,t,r,n){const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s}(t,n,r,e)})}const wd=yd({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),gd=(yd({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),yd({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),yd({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),yd({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),yd({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),yd({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),yd({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),yd({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),bd({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"})),md=(bd({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),yd({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}));function vd(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}(`${e}:trace`);return ad.enabled(`${e}:trace`)&&null!=ad.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=ad(`${e}:trace`)),Object.assign(ad(e),{error:ad(`${e}:error`),trace:t})}yd({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),yd({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),yd({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ad.formatters.b=e=>null==e?"undefined":gd.baseEncode(e),ad.formatters.t=e=>null==e?"undefined":wd.baseEncode(e),ad.formatters.m=e=>null==e?"undefined":md.baseEncode(e),ad.formatters.p=e=>null==e?"undefined":e.toString(),ad.formatters.c=e=>null==e?"undefined":e.toString(),ad.formatters.k=e=>null==e?"undefined":e.toString(),ad.formatters.a=e=>null==e?"undefined":e.toString();const xd=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{const t=[];for await(const r of e)t.push(r);return t})();const t=[];for(const r of e)t.push(r);return t};function Ad(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const Ed=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*h+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,l=o-1;(0!==u||f<i)&&-1!==l;l--,f++)u+=a*s[l]>>>0,s[l]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),b=n;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=t[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var b=c.repeat(r);p<s;++p)b+=e.charAt(h[p]);return b},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class Cd{name;prefix;baseEncode;constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class kd{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return _d(this,e)}}class Sd{decoders;constructor(e){this.decoders=e}or(e){return _d(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function _d(e,t){return new Sd({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class Ud{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Cd(e,t,r),this.decoder=new kd(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function Id({name:e,prefix:t,encode:r,decode:n}){return new Ud(e,t,r,n)}function Td({name:e,prefix:t,alphabet:r}){const{encode:n,decode:i}=Ed(r,e);return Id({prefix:t,name:e,encode:n,decode:e=>Ad(i(e))})}function Dd({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return Id({prefix:t,name:e,encode:e=>function(e,t,r){const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,n,r),decode:t=>function(e,t,r,n){const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s}(t,n,r,e)})}const Bd=Dd({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Pd=Dd({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Nd=Dd({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zd=Dd({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ld=Dd({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Md=Dd({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$d=Dd({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Od=Dd({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Fd=Dd({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Vd=Td({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Rd=Td({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var jd=128,Hd=-128,qd=Math.pow(2,31),Jd=128,Gd=127,Wd=Math.pow(2,7),Qd=Math.pow(2,14),Kd=Math.pow(2,21),Xd=Math.pow(2,28),Zd=Math.pow(2,35),Yd=Math.pow(2,42),ep=Math.pow(2,49),tp=Math.pow(2,56),rp=Math.pow(2,63);const np={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=qd;)r[n++]=255&t|jd,t/=128;for(;t&Hd;)r[n++]=255&t|jd,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&Gd)<<o:(n&Gd)*Math.pow(2,o),o+=7}while(n>=Jd);return e.bytes=s-r,i},encodingLength:function(e){return e<Wd?1:e<Qd?2:e<Kd?3:e<Xd?4:e<Zd?5:e<Yd?6:e<ep?7:e<tp?8:e<rp?9:10}};function ip(e,t=0){return[np.decode(e,t),np.decode.bytes]}function op(e,t,r=0){return np.encode(e,t,r),t}function sp(e){return np.encodingLength(e)}function ap(e,t){const r=t.byteLength,n=sp(e),i=n+sp(r),o=new Uint8Array(i+r);return op(e,o,0),op(r,o,n),o.set(t,i),new cp(e,r,t,o)}class cp{code;size;digest;bytes;constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}function hp(e,t){const{bytes:r,version:n}=e;return 0===n?function(e,t,r){const{prefix:n}=r;if(n!==Vd.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i}(r,fp(e),t??Vd.encoder):function(e,t,r){const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i}(r,fp(e),t??Bd.encoder)}const up=new WeakMap;function fp(e){const t=up.get(e);if(null==t){const t=new Map;return up.set(e,t),t}return t}class lp{code;version;multihash;bytes;"/";constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==dp)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==pp)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return lp.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=ap(e,t);return lp.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return lp.equals(this,e)}static equals(e,t){const r=t;return null!=r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}}(e.multihash,r.multihash)}toString(e){return hp(this,e)}toJSON(){return{"/":hp(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof lp)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new lp(e,r,n,i??bp(e,r,n.bytes))}if(!0===t[yp]){const{version:e,multihash:r,code:n}=t,i=function(e){const t=Ad(e),[r,n]=ip(t),[i,o]=ip(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new cp(r,i,s,t)}(r);return lp.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==dp)throw new Error(`Version 0 CID must use dag-pb (code: ${dp}) block encoding`);return new lp(e,t,r,r.bytes);case 1:{const n=bp(e,t,r.bytes);return new lp(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return lp.create(0,dp,e)}static createV1(e,t){return lp.create(1,e,t)}static decode(e){const[t,r]=lp.decodeFirst(e);if(0!==r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=lp.inspectBytes(e),r=t.size-t.multihashSize,n=Ad(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new cp(t.multihashCode,t.digestSize,i,n);return[0===t.version?lp.createV0(o):lp.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=ip(e.subarray(t));return t+=n,r};let n=r(),i=dp;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=t,s=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[r,n]=function(e,t){switch(e[0]){case"Q":{const r=t??Vd;return[Vd.prefix,r.decode(`${Vd.prefix}${e}`)]}case Vd.prefix:{const r=t??Vd;return[Vd.prefix,r.decode(e)]}case Bd.prefix:{const r=t??Bd;return[Bd.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}(e,t),i=lp.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return fp(i).set(r,e),i}}const dp=112,pp=18;function bp(e,t,r){const n=sp(e),i=n+sp(t),o=new Uint8Array(i+r.byteLength);return op(e,o,0),op(t,o,n),o.set(r,i),o}const yp=Symbol.for("@ipld/js-cid/CID");function wp({name:e,code:t,encode:r}){return new gp(e,t,r)}class gp{name;code;encode;constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?ap(this.code,t):t.then((e=>ap(this.code,e)))}throw Error("Unknown type, must be binary type")}}function mp(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}const vp=wp({name:"sha2-256",code:18,encode:mp("SHA-256")}),xp=wp({name:"sha2-512",code:19,encode:mp("SHA-512")});function Ap(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}const Ep=Td({prefix:"9",name:"base10",alphabet:"0123456789"}),Cp=Dd({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),kp=Dd({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Sp=Dd({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),_p=Array.from(""),Up=_p.reduce(((e,t,r)=>(e[r]=t,e)),[]),Ip=_p.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]),Tp=Id({prefix:"",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+Up[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Ip[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),Dp=Td({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Bp=Td({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Pp=Dd({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Np=Dd({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),zp=Dd({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Lp=Dd({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Mp=Dd({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),$p=Id({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>function(e){return(new TextEncoder).encode(e)}(e)}),Op=new TextEncoder,Fp=new TextDecoder,Vp="json",Rp=512;function jp(e){return Op.encode(JSON.stringify(e))}function Hp(e){return JSON.parse(Fp.decode(e))}const qp="raw",Jp=85;function Gp(e){return Ad(e)}function Wp(e){return Ad(e)}const Qp=Ad,Kp={code:0,name:"identity",encode:Qp,digest:function(e){return ap(0,Qp(e))}},Xp={...te,...K,...ee,...W,...Q,...q,...Z,...J,...Y,...X};function Zp(e=0){return null!=globalThis.Buffer?.allocUnsafe?Ap(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Yp(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const eb=Yp("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),tb=Yp("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=Zp((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),rb={utf8:eb,"utf-8":eb,hex:Xp.base16,latin1:tb,ascii:tb,binary:tb,...Xp};function nb(e,t="utf8"){const r=rb[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Ap(globalThis.Buffer.from(e,"utf-8"))}function ib(e){return function(t){return t instanceof ob?t:new ob(t,e)}}class ob{_value;_hashFn;_depth;_availableBits;_currentBufferIndex;_buffers;constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let r=0;for(;t>0;){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.availableBits(),t);r=(r<<n)+e.take(n),t-=n,this._availableBits-=n,0===e.availableBits()&&this._currentBufferIndex++}return r}untake(e){let t=e;for(;t>0;){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.totalBits()-e.availableBits(),t);e.untake(r),t-=r,this._availableBits+=r,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth>0?function(e,t){if(null!=globalThis.Buffer)return Ap(globalThis.Buffer.concat(e,t));null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=Zp(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return Ap(r)}([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),r=new cb(t);this._buffers.push(r),this._availableBits+=r.availableBits()}}const sb=[255,254,252,248,240,224,192,128],ab=[1,3,7,15,31,63,127,255];class cb{_value;_currentBytePos;_currentBitPos;constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,r=0;for(;t>0&&this._haveBits();){const e=this._value[this._currentBytePos],n=this._currentBitPos+1,i=Math.min(n,t);r=(r<<i)+hb(e,n-i,i),t-=i,this._currentBitPos-=i,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function hb(e,t,r){const n=function(e,t){return sb[e]&ab[Math.min(t+e-1,7)]}(t,r);return(e&n)>>>t}const ub=BigInt(Bs.code);async function fb(e){return(await Bs.encode(e)).subarray(0,8).reverse()}const lb=async(t,r,n)=>{null==n.codec&&(n.codec=e);const i=await vp.digest(t),o=lp.create(n.cidVersion,n.codec.code,i);return await r.put(o,t,{...n,signal:n.signal}),o};class db{options;root;dir;path;dirty;flat;parent;parentKey;unixfs;mode;mtime;cid;size;nodeSize;constructor(e,t){this.options=t??{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime}}class pb extends db{_bucket;constructor(e,t){super(e,t),this._bucket=wc({hashFn:fb,bits:8})}async put(e,t){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(e,t)}async get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}estimateNodeSize(){return void 0!==this.nodeSize||(this.nodeSize=yb(this._bucket,this,this.options)),this.nodeSize}async*flush(e){for await(const t of bb(this._bucket,e,this,this.options))yield{...t,path:this.path}}}async function*bb(e,t,r,n){const i=e._children,o=[];let s=0n;for(let e=0;e<i.length;e++){const r=i.get(e);if(null==r)continue;const a=e.toString(16).toUpperCase().padStart(2,"0");if(r instanceof sc){let e;for await(const i of bb(r,t,null,n))e=i;if(null==e)throw new Error("Could not flush sharded directory, no subshard found");o.push({Name:a,Tsize:Number(e.size),Hash:e.cid}),s+=e.size}else if("function"==typeof r.value.flush){const e=r.value;let n;for await(const r of e.flush(t))n=r,yield n;if(null==n)throw new Error("Did not flush dir");const i=a+r.key;o.push({Name:i,Tsize:Number(n.size),Hash:n.cid}),s+=n.size}else{const e=r.value;if(null==e.cid)continue;const t=a+r.key,n=e.size;o.push({Name:t,Tsize:Number(n),Hash:e.cid}),s+=BigInt(n??0)}}const a=Uint8Array.from(i.bitField().reverse()),c=new ti({type:"hamt-sharded-directory",data:a,fanout:BigInt(e.tableSize()),hashType:ub,mtime:r?.mtime,mode:r?.mode}),h=It(Et({Data:c.marshal(),Links:o})),u=await lb(h,t,n),f=BigInt(h.byteLength)+s;yield{cid:u,unixfs:c,size:f}}function yb(e,t,r){const n=e._children,i=[];for(let e=0;e<n.length;e++){const t=n.get(e);if(null==t)continue;const o=e.toString(16).toUpperCase().padStart(2,"0");if(t instanceof sc){const e=yb(t,null,r);i.push({Name:o,Tsize:Number(e),Hash:0===r.cidVersion?wb:gb})}else if("function"==typeof t.value.flush){const e=t.value.nodeSize();i.push({Name:o+t.key,Tsize:Number(e),Hash:0===r.cidVersion?wb:gb})}else{const e=t.value;if(null==e.cid)continue;const r=o+t.key,n=e.size;i.push({Name:r,Tsize:Number(n),Hash:e.cid})}}const o=Uint8Array.from(n.bitField().reverse());return It(Et({Data:new ti({type:"hamt-sharded-directory",data:o,fanout:BigInt(e.tableSize()),hashType:ub,mtime:t?.mtime,mode:t?.mode}).marshal(),Links:i})).length}const wb=lp.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),gb=lp.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi"),mb=vd("helia:unixfs:commands:utils:hamt-utils"),vb=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),xb=async(e,t,r)=>{const n=ti.unmarshal(e[0].node.Data??new Uint8Array(0)),i=BigInt(Math.pow(2,8));let o,s;e.reverse();for(let a=0;a<e.length;a++){const c=a===e.length-1,h=e[a],u=Uint8Array.from(h.children.bitField().reverse()),f=new ti({type:"hamt-sharded-directory",data:u,fanout:i,hashType:ub});c&&(f.mtime=n.mtime,f.mode=n.mode),s={Data:f.marshal(),Links:h.node.Links};const l=It(Et(s));if(o=await lb(l,t,r),!c){const t=e[a+1];if(null==t)throw new Error("Was not operating on shard root but also had no parent?");mb("updating link in parent sub-shard with prefix %s",t.prefix),t.node.Links=t.node.Links.filter((e=>e.Name!==t.prefix)),t.node.Links.push({Name:t.prefix,Hash:o,Tsize:h.node.Links.reduce(((e,t)=>e+(t.Tsize??0)),l.byteLength)})}}if(null==o||null==s)throw new Error("Noting persisted");return{cid:o,node:s}},Ab=async(e,t,r,n)=>{const i=ib(fb)(nb(t)),o=[];for(;;){const s=Tt(await r.get(e,n)),a=new Ps,c=await i.take(8),h=vb(c);let u;o.push({prefix:h,children:a,node:s});for(const e of s.Links){const t=e.Name??"";if(t.length<2)throw new Error("Invalid HAMT - link name was too short");const r=parseInt(t.substring(0,2),16);a.set(r,!0),t.startsWith(h)&&(u=e)}if(null==u){mb("no link found with prefix %s for %s",h,t);break}const f=u.Name??"";if(f.length<2)throw new Error("Invalid HAMT - link name was too short");if(2!==f.length)break;e=u.Hash,mb("descend into sub-shard with prefix %s",f)}return{path:o,hash:i}};async function Eb(e,t,r,n){if(null==e.Data)throw new Error("DagPB node had no data");const i=ti.unmarshal(e.Data);let o;if("directory"===i.type)o=function(e){let t=0;for(const r of e.Links)t+=(r.Name??"").length,t+=1===r.Hash.version?gb.bytes.byteLength:wb.bytes.byteLength;return t}(e);else{if("hamt-sharded-directory"!==i.type)throw new Error("Can only estimate the size of directories or shards");o=await Cb(e,0,r,t,n)}return o>r}async function Cb(e,t,r,n,i){if(t>r)return r;if(null==e.Data)return t;if(!ti.unmarshal(e.Data).isDirectory())return t;for(const o of e.Links){let e=o.Name??"";if(e=e.substring(2),t+=e.length,t+=o.Hash.bytes.byteLength,o.Hash.code===Ut){const e=Tt(await n.get(o.Hash,i));t+=await Cb(e,t,r,n,i)}}return t}const kb=vd("helia:unixfs:components:utils:add-link");async function Sb(e,t,r,n){if(null==e.node.Data)throw new sd("Invalid parent passed to addLink");if("hamt-sharded-directory"===ti.unmarshal(e.node.Data).type)return kb("adding link to sharded directory"),Ib(e,t,r,n);kb(`adding ${t.Name} (${t.Hash}) to regular directory`);const i=await Ub(e,t,r,n);if(await Eb(i.node,r,n.shardSplitThresholdBytes,n)){kb("converting directory to sharded directory");const e=await _b(i,r);i.cid=e.cid,i.node=Tt(await r.get(e.cid,n))}return i}const _b=async(e,t)=>{if(null==e.node.Data)throw new sd("Invalid parent passed to convertToShardedDirectory");const r=ti.unmarshal(e.node.Data),n=await(async(e,t,r)=>{const n=new pb({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:r.mtime,mode:r.mode},r);for(let e=0;e<t.length;e++)await n._bucket.put(t[e].name,{size:t[e].size,cid:t[e].cid});const i=await Tc(n.flush(e));if(null==i)throw new Error("Flushing shard yielded no result");return i})(t,e.node.Links.map((e=>({name:e.Name??"",size:BigInt(e.Tsize??0),cid:e.Hash}))),{mode:r.mode,mtime:r.mtime,cidVersion:e.cid.version});return kb(`converted directory to sharded directory ${n.cid}`),n},Ub=async(e,t,r,n)=>{const i=e.node.Links.filter((e=>{const r=e.Name===t.Name;if(r&&!n.allowOverwriting)throw new td;return!r}));if(i.push(t),null==e.node.Data)throw new Yl("Parent node with no data passed to addToDirectory");const o=ti.unmarshal(e.node.Data);let s;if(null!=o.mtime){const e=Date.now(),t=Math.floor(e/1e3);o.mtime={secs:BigInt(t),nsecs:1e3*(e-1e3*t)},s=o.marshal()}else s=e.node.Data;e.node=Et({Data:s,Links:i});const a=It(e.node),c=await vp.digest(a),h=lp.create(e.cid.version,Ut,c);return await r.put(h,a),{node:e.node,cid:h}},Ib=async(e,t,r,n)=>{const{path:i,hash:o}=await Ab(e.cid,t.Name,r,n),s=i[i.length-1];if(null==s)throw new Error("Invalid HAMT, could not generate path");const a=s.prefix,c=parseInt(a,16);kb("next prefix for %s is %s",t.Name,a);const h=`${a}${t.Name}`,u=s.node.Links.find((e=>(e.Name??"").startsWith(a)));if(null!=u)if(kb("link %s was present in shard",h),u.Name===h){if(!n.allowOverwriting)throw new td;kb("overwriting %s in subshard",t.Name),s.node.Links=s.node.Links.filter((e=>e.Name!==h)),s.node.Links.push({Name:h,Hash:t.Hash,Tsize:t.Tsize})}else{if(2===u.Name?.length)throw new Error("Existing link was subshard?!");{kb("prefix %s already exists, creating new subshard",a);const e=s.node.Links.findIndex((e=>e.Name?.startsWith(a))),r=s.node.Links.splice(e,1)[0],n=(r.Name??"").substring(2),c=ib(fb)(nb(n));for(let e=0;e<i.length;e++)await c.take(8);for(;;){const e=await c.take(8),s=vb(e);r.Name=`${s}${n}`;const h=await o.take(8),u=vb(h);if(s===u){const e=new Ps;e.set(h,!0),i.push({prefix:u,children:e,node:{Links:[]}});continue}const f=new Ps;f.set(h,!0),f.set(e,!0),i.push({prefix:a,children:f,node:{Links:[r,{Name:`${u}${t.Name}`,Hash:t.Hash,Tsize:t.Tsize}]}});break}}}else kb("link %s was not present in sub-shard",h),t.Name=h,s.node.Links.push(t),s.children.set(c,!0),kb("adding %s to existing sub-shard",h);return xb(i,r,n)};async function Tb(e,t,r={}){const n=await Wl(e,t,r);if("directory"!==n.type)throw new od(`${e.toString()} was not a UnixFS directory`);return{cid:e,node:n.node}}async function Db(e,t,r,n){const i=await Wl(e,r,n);if("directory"!==i.type&&"file"!==i.type&&"raw"!==i.type)throw new Zl(`${e.toString()} was not a UnixFS node`);return{Name:t,Tsize:i.node instanceof Uint8Array?i.node.byteLength:Bb(i.node),Hash:e}}function Bb(e){const t=e.Links.reduce(((e,t)=>e+(t.Tsize??0)),0);return It(e).byteLength+t}const Pb=vd("helia:unixfs:components:utils:resolve");async function Nb(e,t,r,n){if(null==t||""===t)return{cid:e};const i=`/ipfs/${e}${null==t?"":`/${t}`}`,o=await xd(Gl(i,r,n));if(0===o.length)throw new rd("Could not find path in directory");return Pb("resolved %s to %c",t,e),{cid:o[o.length-1].cid,path:t,segments:o}}async function zb(e,t,r,n){if(null==t.segments||0===t.segments.length)return e;let i=t.segments.pop();if(null==i)throw new Error("Insufficient segments");i.cid=e,t.segments.reverse();for(const o of t.segments){const[t,s]=await Promise.all([Tb(o.cid,r,n),Db(i.cid,i.name,r,n)]);e=(await Sb(t,s,r,{...n,allowOverwriting:!0,cidVersion:e.version})).cid,o.cid=e,i=o}return e}const Lb=Kl.bind({ignoreUndefined:!0}),Mb={},$b=262144,Ob=Kl.bind({ignoreUndefined:!0}),Fb=vd("helia:unixfs:chmod"),Vb={recursive:!1,shardSplitThresholdBytes:$b},Rb=Kl.bind({ignoreUndefined:!0}),jb=vd("helia:unixfs:cp"),Hb={force:!1,shardSplitThresholdBytes:$b},qb=Kl.bind({ignoreUndefined:!0}),Jb={},Gb=Kl.bind({ignoreUndefined:!0}),Wb=vd("helia:unixfs:mkdir"),Qb={cidVersion:1,force:!1,shardSplitThresholdBytes:$b},Kb=vd("helia:unixfs:utils:remove-link"),Xb=Kl.bind({ignoreUndefined:!0}),Zb=vd("helia:unixfs:rm"),Yb={shardSplitThresholdBytes:$b};async function ey(t,r,n,i={}){const o=Xb(Yb,i);if(r.includes("/"))throw new sd("Name must not have slashes");const s=await Tb(t,n,o);Zb("Removing %s from %c",r,t);const a=await async function(t,r,n,i){if(null==t.node.Data)throw new Yl("Parent node had no data");if("hamt-sharded-directory"===ti.unmarshal(t.node.Data).type){Kb(`removing ${r} from sharded directory`);const o=await(async(e,t,r,n)=>{const{path:i}=await Ab(e.cid,t,r,n),o=i[i.length-1];if(null==o)throw new Error("Invalid HAMT, could not generate path");const s=o.node.Links.filter((e=>(e.Name??"").substring(2)===t)).map((e=>e.Name)).pop();if(null==s)throw new Error("File not found");const a=s.substring(0,2),c=parseInt(a,16);if(o.node.Links=o.node.Links.filter((e=>e.Name!==s)),o.children.unset(c),1===o.node.Links.length)for(;1!==i.length;){const e=i[i.length-1];if(null==e||e.node.Links.length>1)break;i.pop();const t=i[i.length-1];if(null==t)break;const r=e.node.Links[0];t.node.Links=t.node.Links.filter((e=>!(e.Name??"").startsWith(t.prefix))),t.node.Links.push({Hash:r.Hash,Name:`${t.prefix}${(r.Name??"").substring(2)}`,Tsize:r.Tsize})}return xb(i,r,n)})(t,r,n,i);return await Eb(o.node,n,i.shardSplitThresholdBytes,i)?o:(Kb("converting shard to flat directory %c",t.cid),(async(t,r,n)=>{if(null==t.node.Data)throw new sd("Invalid parent passed to convertToFlatDirectory");const i={Links:[]},o=await Wl(t.cid,r);if("directory"!==o.type)throw new Error("Unexpected node type");for await(const e of o.content()){let t=0;t=e.node instanceof Uint8Array?e.node.byteLength:It(e.node).length,i.Links.push({Hash:e.cid,Name:e.name,Tsize:t})}const s=ti.unmarshal(t.node.Data);i.Data=new ti({type:"directory",mode:s.mode,mtime:s.mtime}).marshal();const a=It(Et(i));return{cid:await lb(a,r,{codec:e,cidVersion:t.cid.version,signal:n.signal}),node:i}})(o,n,i))}return Kb(`removing link ${r} regular directory`),(async(e,t,r,n)=>{e.node.Links=e.node.Links.filter((e=>e.Name!==t));const i=It(e.node),o=await lb(i,r,{...n,cidVersion:e.cid.version});return Kb(`Updated regular directory ${o}`),{node:e.node,cid:o}})(t,r,n,i)}(s,r,n,{...o,cidVersion:t.version});return a.cid}const ty=Kl.bind({ignoreUndefined:!0}),ry=vd("helia:unixfs:stat"),ny={};async function iy(e,t,r={}){const n=ty(ny,r),i=await Nb(e,r.path,t,n);ry("stat %c",i.cid);const o=await Wl(i.cid,t,n);if("file"!==o.type&&"directory"!==o.type&&"raw"!==o.type)throw new Zl;let s,a,c=0n,h=0n,u=0n,f=0n,l=0;const d=o.type;let p;if("raw"===o.type&&(c=BigInt(o.node.byteLength),h=BigInt(o.node.byteLength),u=BigInt(o.node.byteLength),f=BigInt(o.node.byteLength),l=1),"directory"===o.type&&(c=0n,h=BigInt(o.unixfs.marshal().byteLength),u=0n,f=h,l=1,s=o.unixfs.mode,a=o.unixfs.mtime,p=o.unixfs),"file"===o.type){const e=await oy(i.cid,t,n);c=o.unixfs.fileSize(),h=BigInt((o.node.Data?.byteLength??0)+o.node.Links.reduce(((e,t)=>e+(t.Tsize??0)),0)),u=BigInt(e.localFileSize),f=BigInt(e.localDagSize),l=e.blocks,s=o.unixfs.mode,a=o.unixfs.mtime,p=o.unixfs}return{cid:i.cid,mode:s,mtime:a,fileSize:c,dagSize:h,localFileSize:u,localDagSize:f,blocks:l,type:d,unixfs:p}}async function oy(e,t,r){const n={localFileSize:0,localDagSize:0,blocks:0};if(await t.has(e,r)){const i=await t.get(e,r);if(n.blocks++,n.localDagSize+=i.byteLength,e.code===Jp)n.localFileSize+=i.byteLength;else{if(e.code!==Ut)throw new ed(`${e.toString()} was neither DAG_PB nor RAW`);{const o=Tt(i);if(o.Links.length>0)for(const e of o.Links){const i=await oy(e.Hash,t,r);n.localFileSize+=i.localFileSize,n.localDagSize+=i.localDagSize,n.blocks+=i.blocks}else{if(null==o.Data)throw new Yl(`PBNode ${e.toString()} had no data`);const t=ti.unmarshal(o.Data);if(null==t.data)throw new Yl(`UnixFS node ${e.toString()} had no data`);n.localFileSize+=t.data.byteLength??0}}}}return n}const sy=Kl.bind({ignoreUndefined:!0}),ay=vd("helia:unixfs:touch"),cy={recursive:!1,shardSplitThresholdBytes:$b};r(712);class hy{components;constructor(e){this.components=e}async*addAll(e,t={}){yield*async function*(e,t,r={}){yield*_c(e,t,{...Ic,...r})}(e,this.components.blockstore,t)}async addBytes(e,t={}){return async function(e,t,r={}){const{cid:n}=await async function(e,t,r={}){return Uc({content:e},t,r)}(e,t,{...Ic,...r});return n}(e,this.components.blockstore,t)}async addByteStream(e,t={}){return async function(e,t,r={}){const{cid:n}=await async function(e,t,r={}){return Uc({content:e},t,r)}(e,t,{...Ic,...r});return n}(e,this.components.blockstore,t)}async addFile(e,t={}){return async function(e,t,r={}){const{cid:n}=await Uc(e,t,{...Ic,...r});return n}(e,this.components.blockstore,t)}async addDirectory(e={},t={}){return async function(e,t,r={}){const{cid:n}=await async function(e,t,r={}){const n=await se(_c([e],t,r));if(null==n)throw oe(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return n}({...e,path:e.path??"-"},t,{...Ic,...r});return n}(e,this.components.blockstore,t)}async*cat(e,t={}){yield*async function*(e,t,r={}){const n=Lb(Mb,r),i=await Nb(e,n.path,t,n),o=await Wl(i.cid,t,n);if("file"!==o.type&&"raw"!==o.type)throw new id;if(null==o.content)throw new nd;yield*o.content(n)}(e,this.components.blockstore,t)}async chmod(e,t,r={}){return async function(e,t,r,n={}){const i=Ob(Vb,n),o=await Nb(e,i.path,r,n);if(Fb("chmod %c %d",o.cid,t),i.recursive){const s=await Sl((async function*(){for await(const e of Ql(o.cid,r,n)){let r,n=[];if("raw"===e.type)r=new ti({type:"file",data:e.node});else{if("file"!==e.type&&"directory"!==e.type)throw new Zl;r=e.unixfs,n=e.node.Links}r.mode=t;const i={Data:r.marshal(),Links:n};yield{path:e.path,content:i}}}),(t=>_c(t,r,{...i,dagBuilder:async function*(t,r){for await(const n of t)yield async function(){const t=n.content,o=It(t),s=await lb(o,r,{...i,cidVersion:e.version});if(null==t.Data)throw new Yl(`${s} had no data`);const a=ti.unmarshal(t.Data);return{cid:s,size:BigInt(o.length),path:n.path,unixfs:a}}}})),(async e=>Tc(e)));if(null==s)throw new ed(`Could not chmod ${o.cid.toString()}`);return zb(s.cid,o,r,i)}const s=await r.get(o.cid,n);let a,c=[];if(o.cid.code===Jp)a=new ti({type:"file",data:s});else{const e=Tt(s);if(null==e.Data)throw new Yl(`${o.cid.toString()} had no data`);c=e.Links,a=ti.unmarshal(e.Data)}a.mode=t;const h=It({Data:a.marshal(),Links:c}),u=await vp.digest(h),f=lp.create(o.cid.version,Ut,u);return await r.put(f,h),zb(f,o,r,i)}(e,t,this.components.blockstore,r)}async cp(e,t,r,n={}){return async function(e,t,r,n,i={}){const o=Rb(Hb,i);if(r.includes("/"))throw new sd("Name must not have slashes");const[s,a]=await Promise.all([Tb(t,n,o),Db(e,r,n,o)]);return jb('Adding %c as "%s" to %c',e,r,t),(await Sb(s,a,n,{allowOverwriting:o.force,cidVersion:t.version,...o})).cid}(e,t,r,this.components.blockstore,n)}async*ls(e,t={}){yield*async function*(e,t,r={}){const n=qb(Jb,r),i=await Nb(e,n.path,t,n),o=await Wl(i.cid,t);if("file"!==o.type&&"raw"!==o.type){if(null==o.content)throw new nd;if("directory"!==o.type)throw new od;yield*o.content({offset:r.offset,length:r.length})}else yield o}(e,this.components.blockstore,t)}async mkdir(e,t,r={}){return async function(e,t,r,n={}){const i=Gb(Qb,n);if(t.includes("/"))throw new sd("Path must not have slashes");if("directory"!==(await Wl(e,r,n)).type)throw new od(`${e.toString()} was not a UnixFS directory`);Wb("creating %s",t);const o=It({Data:new ti({type:"directory",mode:i.mode,mtime:i.mtime}).marshal(),Links:[]}),s=await vp.digest(o),a=lp.create(i.cidVersion,Ut,s);await r.put(a,o);const[c,h]=await Promise.all([Tb(e,r,i),Db(a,t,r,i)]);return Wb("adding empty dir called %s to %c",t,e),(await Sb(c,h,r,{...i,allowOverwriting:i.force})).cid}(e,t,this.components.blockstore,r)}async rm(e,t,r={}){return ey(e,t,this.components.blockstore,r)}async stat(e,t={}){return iy(e,this.components.blockstore,t)}async touch(e,t={}){return async function(e,t,r={}){const n=sy(cy,r),i=await Nb(e,n.path,t,n),o=n.mtime??{secs:BigInt(Math.round(Date.now()/1e3)),nsecs:0};if(ay("touch %c %o",i.cid,o),n.recursive){const r=await Sl((async function*(){for await(const e of Ql(i.cid,t)){let t,r;if("raw"===e.type)t=new ti({data:e.node}),r=[];else{if("file"!==e.type&&"directory"!==e.type)throw new Zl;t=e.unixfs,r=e.node.Links}t.mtime=o;const n={Data:t.marshal(),Links:r};yield{path:e.path,content:n}}}),(r=>_c(r,t,{...n,dagBuilder:async function*(t,r){for await(const i of t)yield async function(){const t=i.content,o=It(t),s=await lb(o,r,{...n,cidVersion:e.version});if(null==t.Data)throw new Yl(`${s} had no data`);const a=ti.unmarshal(t.Data);return{cid:s,size:BigInt(o.length),path:i.path,unixfs:a}}}})),(async e=>Tc(e)));if(null==r)throw new ed(`Could not chmod ${i.cid.toString()}`);return zb(r.cid,i,t,n)}const s=await t.get(i.cid,r);let a,c=[];if(i.cid.code===Jp)a=new ti({data:s});else{const e=Tt(s);if(c=e.Links,null==e.Data)throw new Yl(`${i.cid.toString()} had no data`);a=ti.unmarshal(e.Data)}a.mtime=o;const h=It({Data:a.marshal(),Links:c}),u=await vp.digest(h),f=lp.create(i.cid.version,Ut,u);return await t.put(f,h),zb(f,i,t,n)}(e,this.components.blockstore,t)}}var uy=128,fy=-128,ly=Math.pow(2,31),dy=128,py=127,by=Math.pow(2,7),yy=Math.pow(2,14),wy=Math.pow(2,21),gy=Math.pow(2,28),my=Math.pow(2,35),vy=Math.pow(2,42),xy=Math.pow(2,49),Ay=Math.pow(2,56),Ey=Math.pow(2,63);const Cy={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=ly;)r[n++]=255&t|uy,t/=128;for(;t&fy;)r[n++]=255&t|uy,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&py)<<o:(n&py)*Math.pow(2,o),o+=7}while(n>=dy);return e.bytes=s-r,i},encodingLength:function(e){return e<by?1:e<yy?2:e<wy?3:e<gy?4:e<my?5:e<vy?6:e<xy?7:e<Ay?8:e<Ey?9:10}},ky=(e,t=0)=>[Cy.decode(e,t),Cy.decode.bytes],Sy=(e,t,r=0)=>(Cy.encode(e,t,r),t),_y=e=>Cy.encodingLength(e),Uy=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class Iy{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Ty=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var o=(e.length-t)*h+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var f=0,l=o-1;(0!==u||f<i)&&-1!==l;l--,f++)u+=a*s[l]>>>0,s[l]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),b=n;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=t[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var b=c.repeat(r);p<s;++p)b+=e.charAt(h[p]);return b},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class Dy{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class By{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ny(this,e)}}class Py{constructor(e){this.decoders=e}or(e){return Ny(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ny=(e,t)=>new Py({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class zy{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Dy(e,t,r),this.decoder=new By(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ly=({name:e,prefix:t,encode:r,decode:n})=>new zy(e,t,r,n),My=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Ty(r,t);return Ly({prefix:e,name:t,encode:n,decode:e=>Uy(i(e))})},$y=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Ly({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let t=0;t<o;++t){const o=i[e[t]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,n,r,e)}),Oy=My({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Fy=(My({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),$y({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),Vy=($y({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),$y({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),$y({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$y({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$y({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$y({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$y({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$y({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),(e,t)=>{const{bytes:r,version:n}=e;return 0===n?Jy(r,jy(e),t||Oy.encoder):Gy(r,jy(e),t||Fy.encoder)}),Ry=new WeakMap,jy=e=>{const t=Ry.get(e);if(null==t){const t=new Map;return Ry.set(e,t),t}return t};class Hy{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Wy)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Qy)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Hy.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=((e,t)=>{const r=t.byteLength,n=_y(e),i=n+_y(r),o=new Uint8Array(i+r);return Sy(e,o,0),Sy(r,o,n),o.set(t,i),new Iy(e,r,t,o)})(e,t);return Hy.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Hy.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return Vy(this,e)}toJSON(){return{"/":Vy(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Hy)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new Hy(e,r,n,i||Ky(e,r,n.bytes))}if(!0===t[Xy]){const{version:e,multihash:r,code:n}=t,i=(e=>{const t=Uy(e),[r,n]=ky(t),[i,o]=ky(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Iy(r,i,s,t)})(r);return Hy.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Wy)throw new Error(`Version 0 CID must use dag-pb (code: ${Wy}) block encoding`);return new Hy(e,t,r,r.bytes);case 1:{const n=Ky(e,t,r.bytes);return new Hy(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Hy.create(0,Wy,e)}static createV1(e,t){return Hy.create(1,e,t)}static decode(e){const[t,r]=Hy.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Hy.inspectBytes(e),r=t.size-t.multihashSize,n=Uy(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new Iy(t.multihashCode,t.digestSize,i,n);return[0===t.version?Hy.createV0(o):Hy.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=ky(e.subarray(t));return t+=n,r};let n=r(),i=Wy;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=t,s=r(),a=r(),c=t+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[r,n]=qy(e,t),i=Hy.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return jy(i).set(r,e),i}}const qy=(e,t)=>{switch(e[0]){case"Q":{const r=t||Oy;return[Oy.prefix,r.decode(`${Oy.prefix}${e}`)]}case Oy.prefix:{const r=t||Oy;return[Oy.prefix,r.decode(e)]}case Fy.prefix:{const r=t||Fy;return[Fy.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Jy=(e,t,r)=>{const{prefix:n}=r;if(n!==Oy.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i},Gy=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i},Wy=112,Qy=18,Ky=(e,t,r)=>{const n=_y(e),i=n+_y(t),o=new Uint8Array(i+r.byteLength);return Sy(e,o,0),Sy(t,o,n),o.set(r,i),o},Xy=Symbol.for("@ipld/js-cid/CID");var Zy=r(597);const Yy=e=>{let t=function(e=null,t=null,r="pending"){this.content={},this.content.cid=e,this.content.type=t.type,this.content.parameters=t.parameters,this.status=r,this.valid=()=>this.content.cid instanceof CID&&"string"==typeof this.content.type,this.isPending=()=>"pending"===this.status,this.isLoading=()=>"loading"===this.status,this.isComplete=()=>"complete"===this.status}(),r=e.dataset.ipfsContentCid,n=e.dataset.ipfsContentType,i=e.dataset.ipfsStatus;if("string"!=typeof r)return t;if("string"!=typeof n)return t;try{t.content.cid=Hy.parse(r),t.content.type=Zy.parse(n).type,t.status=i}catch(e){console.error(e)}return t},ew=class{_unixFs=null;constructor(e){this._unixFs=function(e){return new hy(e)}(e)}action=async e=>{let t=Yy(e);if(!1===t.valid())return!1;if(!1===t.isPending())return!1;let r=await(async(e,t)=>{const r=[];try{for await(const n of e.cat(t))r.push(n);if(0===r.length)throw new Error("No content found for the given CID")}catch(e){console.error(e),r=null}return r})(this._unixfs,t.content.cid);if(0>=r.length)return!1;let n=((e,t)=>{let r=null;try{if(0===e.length)throw new Error("No content found for the given CID");r=new Blob(e,{type:t})}catch(e){console.error(e)}return r})(r,t.content.type);if(null===n)return!1;let i=await(async(e,t,r)=>{try{switch(e.tagName.toLowerCase(),r.content.type){case"audio":case"video":case"image":e.src=URL.createObjectURL(t);break;case"text":let n=await t.text();e.innerHTML=n;break;default:throw new Error(`Unsupported content-type: ${r.content.type}`)}}catch(e){return console.error(e),!1}return!0})(e,n,t);return!1!==i&&i}}})(),n.default})()));